(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[4635],{4970:function(e,t,s){Promise.resolve().then(s.bind(s,4469))},4469:function(e,t,s){"use strict";s.r(t),s.d(t,{default:function(){return p}});var l=s(7437),a=s(2265),i=s(5186),r=s(4072),n=s(9799),c=s(1837),d=s(7766),o=s(4077),x=s(1239),m=s(5805),h=s(1804),u=s(6215),b=s(6337);let g=e=>{let{status:t}=e,s={waiting:{label:"درانتظار",color:"bg-blue-500/20 text-blue-400 border-blue-500/30"},running:{label:"در حال بازی",color:"bg-purple-500/20 text-purple-400 border-purple-500/30"},finished:{label:"پایان یافته",color:"bg-green-500/20 text-green-400 border-green-500/30"},cancelled:{label:"لغو شده",color:"bg-red-500/20 text-red-400 border-red-500/30"}},a=s[t]||s.waiting;return(0,l.jsx)("span",{className:"px-3 py-1 rounded-full text-xs font-bold border ".concat(a.color),children:a.label})};function p(){var e,t,s,p,w,N,v,y,j;let{user:f,refreshMe:E}=(0,d.a)(),[k,C]=(0,a.useState)(null),[D,S]=(0,a.useState)(null),[P,Z]=(0,a.useState)([]),[A,T]=(0,a.useState)(null),[O,_]=(0,a.useState)(!1),[H,I]=(0,a.useState)("single"),M=(0,a.useMemo)(()=>[...P].sort((e,t)=>{var s,l,a,i;if(e.status!==t.status){let s={waiting:0,running:1,finished:2,cancelled:3};return s[e.status]-s[t.status]}return(null!==(a=null===(s=t.players)||void 0===s?void 0:s.length)&&void 0!==a?a:0)-(null!==(i=null===(l=e.players)||void 0===l?void 0:l.length)&&void 0!==i?i:0)}),[P]),J=(0,a.useCallback)(async()=>{try{let[t,s]=await Promise.all([(0,c.Nv)("/slide/single/today",{method:"GET"},{auth:!1}),(0,c.Nv)("/slide/battle/rooms",{method:"GET"},{auth:!1})]);C(t);let l=Array.isArray(null==s?void 0:s.items)?s.items.map(e=>({...e,players:Array.isArray(e.players)?e.players:[]})):[];if(Z(l),null==f?void 0:f.id){var e;let t=l.find(e=>e.players.some(e=>e.userId===f.id));T(null!==(e=null==t?void 0:t.id)&&void 0!==e?e:null)}}catch(e){i.ZP.error(e instanceof Error?e.message:"خطا در دریافت اطلاعات")}},[null==f?void 0:f.id]);async function R(e){if(!f){i.ZP.error("لطفا ابتدا وارد شوید");return}_(!0);try{let t=await (0,c.Nv)("/slide/single/spin",{method:"POST",body:JSON.stringify({stakeType:e})});S(t),await E(),t.win?i.ZP.success("\uD83C\uDF89 تبریک! شما برنده شدید!"):i.ZP.error("این بار خوش شانس نبودی \uD83D\uDE14")}catch(e){i.ZP.error(e instanceof Error?e.message:"چرخش انجام نشد")}finally{_(!1)}}async function F(e,t){if(!f){i.ZP.error("لطفا ابتدا وارد شوید");return}_(!0);try{let s=await (0,c.Nv)("/slide/battle/join",{method:"POST",body:JSON.stringify({roomId:t,entryAsset:e,entryAmount:"CHANCE"===e?5:1e4,maxPlayers:10})});T(s.roomId),await E(),await J(),i.ZP.success("\uD83C\uDFAE وارد اتاق شدی!")}catch(e){i.ZP.error(e instanceof Error?e.message:"ورود به اتاق ناموفق بود")}finally{_(!1)}}return(0,a.useEffect)(()=>{J();let e=setInterval(()=>void J(),5e3);return()=>clearInterval(e)},[J]),(0,l.jsx)("main",{className:"min-h-screen pt-20 pb-24 px-4 sm:px-6 lg:px-8",dir:"rtl",children:(0,l.jsxs)("div",{className:"max-w-7xl mx-auto",children:[(0,l.jsx)(r.E.div,{initial:{opacity:0,y:-20},animate:{opacity:1,y:0},className:"mb-6 sm:mb-8",children:(0,l.jsxs)("div",{className:"relative rounded-3xl border border-white/10 bg-gradient-to-br from-accent-gold/10 via-transparent to-accent-cyan/10 p-5 sm:p-6 overflow-hidden",children:[(0,l.jsx)("div",{className:"absolute inset-0 bg-[radial-gradient(circle_at_30%_50%,rgba(251,191,36,0.1)_0%,transparent_50%)] pointer-events-none"}),(0,l.jsxs)("div",{className:"relative",children:[(0,l.jsxs)("div",{className:"flex items-center gap-2 sm:gap-3 mb-2",children:[(0,l.jsx)("div",{className:"p-2 bg-accent-gold/20 rounded-lg",children:(0,l.jsx)(o.Z,{className:"w-5 h-5 sm:w-6 sm:h-6 text-accent-gold"})}),(0,l.jsx)("h1",{className:"text-2xl sm:text-3xl font-black text-white",children:"اسلاید آرنا"})]}),(0,l.jsx)("p",{className:"text-xs sm:text-sm text-white/60",children:"بازی‌های شانس و قرعه‌کشی"})]})]})}),(0,l.jsx)("div",{className:"flex gap-2 sm:gap-3 mb-6 flex-wrap",children:["single","battle"].map(e=>(0,l.jsxs)("button",{onClick:()=>I(e),className:"flex items-center gap-1.5 px-4 sm:px-5 py-2 rounded-xl font-bold text-sm transition-all ".concat(H===e?"bg-accent-gold text-dark-bg shadow-lg shadow-accent-gold/30":"bg-white/5 text-white border border-white/10 hover:bg-white/10"),children:["single"===e?(0,l.jsx)(x.Z,{className:"w-4 h-4"}):(0,l.jsx)(m.Z,{className:"w-4 h-4"}),"single"===e?"قرعه روزانه":"تالار پنج نفر"]},e))}),(0,l.jsx)(n.M,{mode:"wait",children:"single"===H&&(0,l.jsx)(r.E.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},exit:{opacity:0,y:-20},className:"mb-6",children:(0,l.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-5 sm:gap-6",children:[(0,l.jsx)("div",{className:"lg:col-span-2",children:(0,l.jsxs)("div",{className:"rounded-2xl border border-white/10 bg-gradient-to-br from-white/5 to-white/[0.02] backdrop-blur-xl p-5 sm:p-6",children:[(0,l.jsxs)("div",{className:"mb-5 sm:mb-6",children:[(0,l.jsxs)("h2",{className:"text-lg sm:text-xl font-bold mb-1 flex items-center gap-2",children:[(0,l.jsx)(x.Z,{className:"w-5 h-5 text-accent-gold"}),"قرعه روزانه"]}),(0,l.jsx)("p",{className:"text-xs sm:text-sm text-white/60",children:"رقم هدف را حدس بزنید"})]}),(null==k?void 0:k.hasTarget)&&(0,l.jsxs)(r.E.div,{initial:{scale:.8,opacity:0},animate:{scale:1,opacity:1},className:"mb-6 p-4 sm:p-5 rounded-xl bg-gradient-to-br from-accent-gold/20 to-accent-cyan/20 border border-accent-gold/30",children:[(0,l.jsx)("p",{className:"text-white/70 text-xs font-bold mb-2",children:"رقم امروز"}),(0,l.jsx)("p",{className:"text-4xl sm:text-5xl font-black text-accent-gold",children:null!==(s=null==k?void 0:k.targetNumber)&&void 0!==s?s:"-"})]}),(0,l.jsxs)("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-3 mb-5",children:[(0,l.jsx)(r.E.button,{whileHover:{scale:1.05},whileTap:{scale:.95},disabled:O||!f,onClick:()=>R("chance"),className:"px-4 py-3 sm:py-4 bg-gradient-to-r from-accent-gold to-yellow-400 text-dark-bg font-bold rounded-lg shadow-lg shadow-accent-gold/30 hover:shadow-xl disabled:opacity-50 transition-all text-sm sm:text-base",children:(0,l.jsxs)("div",{className:"flex items-center justify-center gap-1.5",children:[(0,l.jsx)(x.Z,{className:"w-4 h-4"}),"۱ سهم شانس"]})}),(0,l.jsx)(r.E.button,{whileHover:{scale:1.05},whileTap:{scale:.95},disabled:O||!f,onClick:()=>R("irr"),className:"px-4 py-3 sm:py-4 bg-white/10 text-white font-bold rounded-lg border border-white/20 hover:border-white/40 hover:bg-white/15 disabled:opacity-50 transition-all text-sm sm:text-base",children:(0,l.jsxs)("div",{className:"flex items-center justify-center gap-1.5",children:[(0,l.jsx)(h.Z,{className:"w-4 h-4"}),"۱۰ هزار تومان"]})})]}),(0,l.jsx)(n.M,{children:D&&(0,l.jsxs)(r.E.div,{initial:{scale:.8,opacity:0},animate:{scale:1,opacity:1},exit:{scale:.8,opacity:0},className:"rounded-lg border p-4 text-sm ".concat(D.win?"bg-green-500/10 border-green-500/30":"bg-red-500/10 border-red-500/30"),children:[(0,l.jsx)("h3",{className:"font-bold mb-2 text-sm",children:D.win?"\uD83C\uDF89 برنده!":"\uD83D\uDE14 باخت"}),(0,l.jsxs)("div",{className:"grid grid-cols-2 gap-2 text-xs",children:[(0,l.jsxs)("div",{className:"bg-white/5 rounded-lg p-2",children:[(0,l.jsx)("p",{className:"text-white/60 mb-1",children:"شما"}),(0,l.jsx)("p",{className:"font-bold text-accent-gold",children:null!==(w=null!==(p=D.rolledNumber)&&void 0!==p?p:D.position)&&void 0!==w?w:"-"})]}),(0,l.jsxs)("div",{className:"bg-white/5 rounded-lg p-2",children:[(0,l.jsx)("p",{className:"text-white/60 mb-1",children:"رقم"}),(0,l.jsx)("p",{className:"font-bold text-accent-cyan",children:null!==(v=null!==(N=D.targetNumber)&&void 0!==N?N:null==k?void 0:k.targetNumber)&&void 0!==v?v:"-"})]})]}),D.reward&&(0,l.jsxs)("div",{className:"mt-3 p-2 bg-accent-gold/20 rounded-lg text-xs",children:[(0,l.jsx)("p",{className:"text-white/70 mb-1",children:"جایزه"}),(0,l.jsxs)("p",{className:"font-bold text-accent-gold",children:[Number(D.reward).toLocaleString("fa-IR")," \uD83D\uDCB0"]})]})]})})]})}),(0,l.jsx)("div",{className:"space-y-4",children:(0,l.jsxs)("div",{className:"rounded-2xl border border-white/10 bg-gradient-to-br from-white/5 to-white/[0.02] backdrop-blur-xl p-5 sm:p-6",children:[(0,l.jsxs)("h3",{className:"text-sm font-bold mb-4 flex items-center gap-2",children:[(0,l.jsx)(u.Z,{className:"w-4 h-4 text-accent-gold"}),"موجودی"]}),(0,l.jsxs)("div",{className:"space-y-2",children:[(0,l.jsxs)("div",{className:"bg-white/5 rounded-lg p-3 border border-white/10",children:[(0,l.jsx)("p",{className:"text-white/60 text-xs mb-1",children:"تومان"}),(0,l.jsx)("p",{className:"text-lg sm:text-xl font-bold text-accent-gold",children:null!==(y=null==f?void 0:null===(e=f.walletBalance)||void 0===e?void 0:e.toLocaleString("fa-IR"))&&void 0!==y?y:"0"})]}),(0,l.jsxs)("div",{className:"bg-white/5 rounded-lg p-3 border border-white/10",children:[(0,l.jsx)("p",{className:"text-white/60 text-xs mb-1",children:"سهم شانس"}),(0,l.jsx)("p",{className:"text-lg sm:text-xl font-bold text-accent-cyan",children:null!==(j=null==f?void 0:null===(t=f.chances)||void 0===t?void 0:t.toLocaleString("fa-IR"))&&void 0!==j?j:"0"})]})]})]})})]})},"single")}),(0,l.jsx)(n.M,{mode:"wait",children:"battle"===H&&(0,l.jsxs)(r.E.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},exit:{opacity:0,y:-20},children:[(0,l.jsxs)("div",{className:"rounded-2xl border border-white/10 bg-gradient-to-br from-white/5 to-white/[0.02] backdrop-blur-xl p-5 sm:p-6 mb-6",children:[(0,l.jsxs)("h2",{className:"text-lg sm:text-xl font-bold mb-2 flex items-center gap-2",children:[(0,l.jsx)(m.Z,{className:"w-5 h-5 text-accent-cyan"}),"تالار پنج نفر"]}),(0,l.jsx)("p",{className:"text-xs sm:text-sm text-white/60 mb-4",children:"با هم بازی کنید، برنده همه پول را می‌برد"}),(0,l.jsxs)("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-2.5",children:[(0,l.jsx)(r.E.button,{whileHover:{scale:1.05},whileTap:{scale:.95},disabled:O||!f,onClick:()=>F("CHANCE"),className:"px-4 py-2.5 sm:py-3 bg-gradient-to-r from-purple-600 to-purple-500 text-white font-bold rounded-lg shadow-lg shadow-purple-600/30 disabled:opacity-50 transition-all text-sm",children:(0,l.jsxs)("div",{className:"flex items-center justify-center gap-1.5",children:[(0,l.jsx)(x.Z,{className:"w-4 h-4"}),"۵ سهم شانس"]})}),(0,l.jsx)(r.E.button,{whileHover:{scale:1.05},whileTap:{scale:.95},disabled:O||!f,onClick:()=>F("IRR"),className:"px-4 py-2.5 sm:py-3 bg-gradient-to-r from-blue-600 to-blue-500 text-white font-bold rounded-lg shadow-lg shadow-blue-600/30 disabled:opacity-50 transition-all text-sm",children:(0,l.jsxs)("div",{className:"flex items-center justify-center gap-1.5",children:[(0,l.jsx)(h.Z,{className:"w-4 h-4"}),"۵۰ هزار تومان"]})})]})]}),(0,l.jsxs)("div",{className:"space-y-3",children:[(0,l.jsx)("h3",{className:"text-base sm:text-lg font-bold",children:"تالارهای فعال"}),(0,l.jsx)(n.M,{mode:"wait",children:M.length>0?(0,l.jsx)(r.E.div,{className:"grid gap-3 grid-cols-1 sm:grid-cols-2",children:M.map((e,t)=>{var s,a,i,n;let c=(null!==(i=null===(s=e.players)||void 0===s?void 0:s.length)&&void 0!==i?i:0)>=e.maxPlayers,d=A===e.id,o=null!==(n=null===(a=e.players)||void 0===a?void 0:a.length)&&void 0!==n?n:0;return(0,l.jsxs)(r.E.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{delay:.05*t},className:"relative rounded-lg border p-4 backdrop-blur-xl transition-all text-sm ".concat(d?"border-accent-gold/60 bg-accent-gold/10 shadow-lg shadow-accent-gold/20":"border-white/10 bg-white/[0.03] hover:border-white/20"),children:[d&&(0,l.jsx)("div",{className:"absolute -top-2 -right-2 bg-accent-gold text-dark-bg px-2 py-0.5 rounded-full text-xs font-bold",children:"شما"}),(0,l.jsxs)("div",{className:"flex items-start justify-between mb-3",children:[(0,l.jsxs)("div",{className:"flex-1",children:[(0,l.jsx)("p",{className:"text-xs text-white/60 mb-0.5",children:"کد"}),(0,l.jsx)("p",{className:"font-mono text-xs font-bold text-white",children:e.id.slice(0,6)})]}),(0,l.jsx)(g,{status:e.status})]}),(0,l.jsxs)("div",{className:"bg-white/5 rounded-lg p-2 mb-2.5",children:[(0,l.jsx)("p",{className:"text-xs text-white/60 mb-0.5",children:"ورودی"}),(0,l.jsxs)("p",{className:"text-sm font-bold text-accent-gold",children:[e.entryAmount," ","CHANCE"===e.entryAsset?"⚡":"\uD83D\uDCB0"]})]}),(0,l.jsxs)("div",{className:"grid grid-cols-2 gap-2 mb-3",children:[(0,l.jsxs)("div",{className:"bg-white/5 rounded-lg p-2",children:[(0,l.jsx)("p",{className:"text-xs text-white/60",children:"نفر"}),(0,l.jsxs)("p",{className:"text-sm font-bold text-accent-cyan",children:[o,"/",e.maxPlayers]})]}),(0,l.jsxs)("div",{className:"bg-white/5 rounded-lg p-2",children:[(0,l.jsx)("p",{className:"text-xs text-white/60",children:"جام"}),(0,l.jsx)("p",{className:"text-sm font-bold text-accent-gold",children:e.potAmount?"".concat((e.potAmount/1e3).toFixed(0),"K"):"0"})]})]}),(0,l.jsx)("button",{disabled:O||c||"waiting"!==e.status||!f,onClick:()=>F(e.entryAsset,e.id),className:"w-full py-2 rounded-lg font-bold text-xs transition-all ".concat(d?"bg-accent-gold/30 text-accent-gold cursor-default":c||"waiting"!==e.status?"bg-white/5 text-white/40 cursor-not-allowed":"bg-white/10 text-white hover:bg-white/20"),children:d?"✓ شما اینجا":c?"پر":"waiting"!==e.status?"شروع شده":"ورود"})]},e.id)})}):(0,l.jsxs)(r.E.div,{initial:{opacity:0},animate:{opacity:1},className:"text-center py-8",children:[(0,l.jsx)(b.Z,{className:"w-10 h-10 text-white/30 mx-auto mb-3"}),(0,l.jsx)("p",{className:"text-white/60 text-sm",children:"تالاری باز نیست"})]})})]})]},"battle")})]})})}},7766:function(e,t,s){"use strict";s.d(t,{H:function(){return d},a:function(){return o}});var l=s(7437),a=s(2265),i=s(1837),r=s(5572);let n=(0,a.createContext)(null);async function c(){return(0,i.Nv)("/me",{method:"GET"},{auth:!0})}function d(e){let{children:t}=e,[s,d]=(0,a.useState)(null),[o,x]=(0,a.useState)(!0),m=(0,a.useCallback)(async()=>{try{let e=await c();d(e)}catch(e){d(null)}},[]);(0,a.useEffect)(()=>{let e=!0;return(async()=>{try{let t=await c();e&&d(t)}catch(t){e&&d(null)}finally{e&&x(!1)}})(),()=>{e=!1}},[]);let h=(0,a.useCallback)(async e=>{let{email:t,password:s}=e,l=await (0,i.Nv)("/auth/login",{method:"POST",body:JSON.stringify({email:t,password:s})},{auth:!1});return(0,i.vD)({accessToken:l.accessToken,refreshToken:l.refreshToken}),(0,r.DM)(l.user),d(l.user),l.user},[]),u=(0,a.useCallback)(async e=>{let{email:t,password:s,referralCode:l}=e;await (0,i.Nv)("/auth/register",{method:"POST",body:JSON.stringify({email:t,password:s,referralCode:l})},{auth:!1})},[]),b=(0,a.useCallback)(async()=>{try{await (0,i.Nv)("/auth/logout",{method:"POST",body:JSON.stringify({})})}catch(e){}finally{(0,i.Je)(),(0,r.DM)(null),d(null)}},[]),g=(0,a.useMemo)(()=>({user:s,isLoading:o,isAuthenticated:!!s,login:h,register:u,logout:b,refreshMe:m}),[s,o,h,u,b,m]);return(0,l.jsx)(n.Provider,{value:g,children:t})}function o(){let e=(0,a.useContext)(n);if(!e)throw Error("useAuth must be used within AuthProvider");return e}}},function(e){e.O(0,[5186,4072,3462,1837,2971,2117,1744],function(){return e(e.s=4970)}),_N_E=e.O()}]);