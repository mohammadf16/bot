(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[2626],{2079:function(e,t,r){Promise.resolve().then(r.bind(r,5340))},8755:function(e,t,r){"use strict";r.d(t,{Z:function(){return d}});var a=r(2265);let n=function(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];return t.filter((e,t,r)=>!!e&&""!==e.trim()&&r.indexOf(e)===t).join(" ").trim()},s=e=>e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),l=e=>e.replace(/^([A-Z])|[\s-_]+(\w)/g,(e,t,r)=>r?r.toUpperCase():t.toLowerCase()),u=e=>{let t=l(e);return t.charAt(0).toUpperCase()+t.slice(1)};var i={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};let c=e=>{for(let t in e)if(t.startsWith("aria-")||"role"===t||"title"===t)return!0;return!1},o=(0,a.forwardRef)((e,t)=>{let{color:r="currentColor",size:s=24,strokeWidth:l=2,absoluteStrokeWidth:u,className:o="",children:d,iconNode:h,...f}=e;return(0,a.createElement)("svg",{ref:t,...i,width:s,height:s,stroke:r,strokeWidth:u?24*Number(l)/Number(s):l,className:n("lucide",o),...!d&&!c(f)&&{"aria-hidden":"true"},...f},[...h.map(e=>{let[t,r]=e;return(0,a.createElement)(t,r)}),...Array.isArray(d)?d:[d]])}),d=(e,t)=>{let r=(0,a.forwardRef)((r,l)=>{let{className:i,...c}=r;return(0,a.createElement)(o,{ref:l,iconNode:t,className:n("lucide-".concat(s(u(e))),"lucide-".concat(e),i),...c})});return r.displayName=u(e),r}},7648:function(e,t,r){"use strict";r.d(t,{default:function(){return n.a}});var a=r(2972),n=r.n(a)},9376:function(e,t,r){"use strict";var a=r(5475);r.o(a,"usePathname")&&r.d(t,{usePathname:function(){return a.usePathname}}),r.o(a,"useRouter")&&r.d(t,{useRouter:function(){return a.useRouter}})},5340:function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return o}});var a=r(7437),n=r(2265),s=r(7648),l=r(9376),u=r(5186);let i=(0,r(8755).Z)("log-in",[["path",{d:"m10 17 5-5-5-5",key:"1bsop3"}],["path",{d:"M15 12H3",key:"6jk70r"}],["path",{d:"M15 3h4a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2h-4",key:"u53s6r"}]]);var c=r(7766);function o(){let e=(0,l.useRouter)(),{login:t,isAuthenticated:r,isLoading:o}=(0,c.a)(),[d,h]=(0,n.useState)(""),[f,m]=(0,n.useState)(""),[x,b]=(0,n.useState)(!1);async function p(r){r.preventDefault(),b(!0);try{await t({email:d,password:f}),u.ZP.success("ورود با موفقیت انجام شد"),e.replace("/")}catch(e){u.ZP.error(e instanceof Error?e.message:"خطا در ورود")}finally{b(!1)}}return(0,n.useEffect)(()=>{!o&&r&&e.replace("/")},[r,o,e]),(0,a.jsx)("main",{className:"min-h-screen pt-32 pb-20",children:(0,a.jsx)("div",{className:"max-w-md mx-auto px-4",dir:"rtl",children:(0,a.jsxs)("div",{className:"card glass p-8",children:[(0,a.jsx)("h1",{className:"text-3xl font-black mb-2",children:"ورود"}),(0,a.jsx)("p",{className:"text-sm text-dark-text/60 mb-6",children:"برای خرید بلیط، کیف پول و پنل مدیریت وارد شوید."}),(0,a.jsxs)("form",{onSubmit:p,className:"space-y-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm text-dark-text/70 mb-2",children:"ایمیل"}),(0,a.jsx)("input",{type:"email",value:d,onChange:e=>h(e.target.value),className:"w-full bg-dark-bg/50 border border-dark-border/40 rounded-xl px-4 py-3",required:!0})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm text-dark-text/70 mb-2",children:"رمز عبور"}),(0,a.jsx)("input",{type:"password",value:f,onChange:e=>m(e.target.value),className:"w-full bg-dark-bg/50 border border-dark-border/40 rounded-xl px-4 py-3",required:!0})]}),(0,a.jsxs)("button",{disabled:x,className:"btn-primary w-full disabled:opacity-60",children:[(0,a.jsx)(i,{size:18}),x?"در حال ورود...":"ورود به حساب"]})]}),(0,a.jsxs)("p",{className:"mt-6 text-sm text-dark-text/60",children:["حساب ندارید؟"," ",(0,a.jsx)(s.default,{href:"/register",className:"text-accent-gold font-bold",children:"ثبت نام"})]})]})})})}},7766:function(e,t,r){"use strict";r.d(t,{H:function(){return c},a:function(){return o}});var a=r(7437),n=r(2265),s=r(1837),l=r(5572);let u=(0,n.createContext)(null);async function i(){return(0,s.Nv)("/me",{method:"GET"},{auth:!0})}function c(e){let{children:t}=e,[r,c]=(0,n.useState)(null),[o,d]=(0,n.useState)(!0),h=(0,n.useCallback)(async()=>{try{let e=await i();c(e)}catch(e){c(null)}},[]);(0,n.useEffect)(()=>{let e=!0;return(async()=>{try{let t=await i();e&&c(t)}catch(t){e&&c(null)}finally{e&&d(!1)}})(),()=>{e=!1}},[]);let f=(0,n.useCallback)(async e=>{let{email:t,password:r}=e,a=await (0,s.Nv)("/auth/login",{method:"POST",body:JSON.stringify({email:t,password:r})},{auth:!1});return(0,s.vD)({accessToken:a.accessToken,refreshToken:a.refreshToken}),(0,l.DM)(a.user),c(a.user),a.user},[]),m=(0,n.useCallback)(async e=>{let{email:t,password:r,referralCode:a}=e;await (0,s.Nv)("/auth/register",{method:"POST",body:JSON.stringify({email:t,password:r,referralCode:a})},{auth:!1})},[]),x=(0,n.useCallback)(async()=>{try{await (0,s.Nv)("/auth/logout",{method:"POST",body:JSON.stringify({})})}catch(e){}finally{(0,s.Je)(),(0,l.DM)(null),c(null)}},[]),b=(0,n.useMemo)(()=>({user:r,isLoading:o,isAuthenticated:!!r,login:f,register:m,logout:x,refreshMe:h}),[r,o,f,m,x,h]);return(0,a.jsx)(u.Provider,{value:b,children:t})}function o(){let e=(0,n.useContext)(u);if(!e)throw Error("useAuth must be used within AuthProvider");return e}}},function(e){e.O(0,[5186,2972,1837,2971,2117,1744],function(){return e(e.s=2079)}),_N_E=e.O()}]);