(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[8118],{5328:function(e,t,a){Promise.resolve().then(a.bind(a,5390))},8755:function(e,t,a){"use strict";a.d(t,{Z:function(){return u}});var n=a(2265);let r=function(){for(var e=arguments.length,t=Array(e),a=0;a<e;a++)t[a]=arguments[a];return t.filter((e,t,a)=>!!e&&""!==e.trim()&&a.indexOf(e)===t).join(" ").trim()},s=e=>e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),i=e=>e.replace(/^([A-Z])|[\s-_]+(\w)/g,(e,t,a)=>a?a.toUpperCase():t.toLowerCase()),l=e=>{let t=i(e);return t.charAt(0).toUpperCase()+t.slice(1)};var c={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};let o=e=>{for(let t in e)if(t.startsWith("aria-")||"role"===t||"title"===t)return!0;return!1},d=(0,n.forwardRef)((e,t)=>{let{color:a="currentColor",size:s=24,strokeWidth:i=2,absoluteStrokeWidth:l,className:d="",children:u,iconNode:h,...m}=e;return(0,n.createElement)("svg",{ref:t,...c,width:s,height:s,stroke:a,strokeWidth:l?24*Number(i)/Number(s):i,className:r("lucide",d),...!u&&!o(m)&&{"aria-hidden":"true"},...m},[...h.map(e=>{let[t,a]=e;return(0,n.createElement)(t,a)}),...Array.isArray(u)?u:[u]])}),u=(e,t)=>{let a=(0,n.forwardRef)((a,i)=>{let{className:c,...o}=a;return(0,n.createElement)(d,{ref:i,iconNode:t,className:r("lucide-".concat(s(l(e))),"lucide-".concat(e),c),...o})});return a.displayName=l(e),a}},2735:function(e,t,a){"use strict";a.d(t,{Z:function(){return n}});let n=(0,a(8755).Z)("download",[["path",{d:"M12 15V3",key:"m9g1x1"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["path",{d:"m7 10 5 5 5-5",key:"brsn70"}]])},9397:function(e,t,a){"use strict";a.d(t,{Z:function(){return n}});let n=(0,a(8755).Z)("plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]])},3229:function(e,t,a){"use strict";a.d(t,{Z:function(){return n}});let n=(0,a(8755).Z)("save",[["path",{d:"M15.2 3a2 2 0 0 1 1.4.6l3.8 3.8a2 2 0 0 1 .6 1.4V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2z",key:"1c8476"}],["path",{d:"M17 21v-7a1 1 0 0 0-1-1H8a1 1 0 0 0-1 1v7",key:"1ydtos"}],["path",{d:"M7 3v4a1 1 0 0 0 1 1h7",key:"t51u73"}]])},8930:function(e,t,a){"use strict";a.d(t,{Z:function(){return n}});let n=(0,a(8755).Z)("trash-2",[["path",{d:"M10 11v6",key:"nco0om"}],["path",{d:"M14 11v6",key:"outv1u"}],["path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6",key:"miytrc"}],["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2",key:"e791ji"}]])},5805:function(e,t,a){"use strict";a.d(t,{Z:function(){return n}});let n=(0,a(8755).Z)("users",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["path",{d:"M16 3.128a4 4 0 0 1 0 7.744",key:"16gr8j"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}]])},257:function(e,t,a){"use strict";var n,r;e.exports=(null==(n=a.g.process)?void 0:n.env)&&"object"==typeof(null==(r=a.g.process)?void 0:r.env)?a.g.process:a(4227)},4227:function(e){!function(){var t={229:function(e){var t,a,n,r=e.exports={};function s(){throw Error("setTimeout has not been defined")}function i(){throw Error("clearTimeout has not been defined")}function l(e){if(t===setTimeout)return setTimeout(e,0);if((t===s||!t)&&setTimeout)return t=setTimeout,setTimeout(e,0);try{return t(e,0)}catch(a){try{return t.call(null,e,0)}catch(a){return t.call(this,e,0)}}}!function(){try{t="function"==typeof setTimeout?setTimeout:s}catch(e){t=s}try{a="function"==typeof clearTimeout?clearTimeout:i}catch(e){a=i}}();var c=[],o=!1,d=-1;function u(){o&&n&&(o=!1,n.length?c=n.concat(c):d=-1,c.length&&h())}function h(){if(!o){var e=l(u);o=!0;for(var t=c.length;t;){for(n=c,c=[];++d<t;)n&&n[d].run();d=-1,t=c.length}n=null,o=!1,function(e){if(a===clearTimeout)return clearTimeout(e);if((a===i||!a)&&clearTimeout)return a=clearTimeout,clearTimeout(e);try{a(e)}catch(t){try{return a.call(null,e)}catch(t){return a.call(this,e)}}}(e)}}function m(e,t){this.fun=e,this.array=t}function x(){}r.nextTick=function(e){var t=Array(arguments.length-1);if(arguments.length>1)for(var a=1;a<arguments.length;a++)t[a-1]=arguments[a];c.push(new m(e,t)),1!==c.length||o||l(h)},m.prototype.run=function(){this.fun.apply(null,this.array)},r.title="browser",r.browser=!0,r.env={},r.argv=[],r.version="",r.versions={},r.on=x,r.addListener=x,r.once=x,r.off=x,r.removeListener=x,r.removeAllListeners=x,r.emit=x,r.prependListener=x,r.prependOnceListener=x,r.listeners=function(e){return[]},r.binding=function(e){throw Error("process.binding is not supported")},r.cwd=function(){return"/"},r.chdir=function(e){throw Error("process.chdir is not supported")},r.umask=function(){return 0}}},a={};function n(e){var r=a[e];if(void 0!==r)return r.exports;var s=a[e]={exports:{}},i=!0;try{t[e](s,s.exports,n),i=!1}finally{i&&delete a[e]}return s.exports}n.ab="//";var r=n(229);e.exports=r}()},5390:function(e,t,a){"use strict";a.r(t),a.d(t,{default:function(){return p}});var n=a(7437),r=a(2265),s=a(9397),i=a(8930),l=a(3229),c=a(5805);let o=(0,a(8755).Z)("play",[["path",{d:"M5 5a2 2 0 0 1 3.008-1.728l11.997 6.998a2 2 0 0 1 .003 3.458l-12 7A2 2 0 0 1 5 19z",key:"10ikf1"}]]);var d=a(2735),u=a(5186),h=a(1837),m=a(7921);function x(e){let t=e.getFullYear(),a=String(e.getMonth()+1).padStart(2,"0"),n=String(e.getDate()).padStart(2,"0"),r=String(e.getHours()).padStart(2,"0"),s=String(e.getMinutes()).padStart(2,"0");return"".concat(t,"-").concat(a,"-").concat(n,"T").concat(r,":").concat(s)}function p(){var e,t,a;let[p,f]=(0,r.useState)([]),[g,b]=(0,r.useState)(null),[y,v]=(0,r.useState)(!1),[w,N]=(0,r.useState)(null),[j,k]=(0,r.useState)(null),[S,T]=(0,r.useState)(null),[C,Z]=(0,r.useState)(null),[E,P]=(0,r.useState)({}),[L,I]=(0,r.useState)("قرعه کشي اسلايد خودرو"),[M,O]=(0,r.useState)(""),[R,A]=(0,r.useState)([{rankFrom:1,rankTo:1,title:"خودرو",amount:0},{rankFrom:2,rankTo:3,title:"جايزه نقدي",amount:2e8},{rankFrom:4,rankTo:1e3,title:"کش بک",amount:5e5}]),[_,D]=(0,r.useState)(50),[U,F]=(0,r.useState)(new Date().toISOString().slice(0,10)),[z,H]=(0,r.useState)(42);async function J(){try{let[e,t]=await Promise.all([(0,h.Nv)("/admin/slide/draws"),(0,h.Nv)("/admin/slide/preview")]);f(e.items),b(t);try{let e=await (0,h.Nv)("/admin/game/difficulty");D(e.difficulty)}catch(e){}}catch(e){u.ZP.error(e instanceof Error?e.message:"خطا در دريافت اطلاعات")}}async function B(){try{await (0,h.Nv)("/admin/game/difficulty",{method:"PUT",body:JSON.stringify({difficulty:_})}),u.ZP.success("درجه سختی بازی ذخیره شد")}catch(e){u.ZP.error(e instanceof Error?e.message:"ذخیره سختی ناموفق بود")}}async function V(){try{await (0,h.Nv)("/admin/slide/single/target",{method:"POST",body:JSON.stringify({targetDate:U,winningNumber:z})}),u.ZP.success("عدد برنده روزانه ثبت شد")}catch(e){u.ZP.error(e instanceof Error?e.message:"ثبت عدد روزانه ناموفق بود")}}(0,r.useEffect)(()=>{J()},[]);let W=(0,r.useMemo)(()=>p.find(e=>"scheduled"===e.status),[p]);(0,r.useEffect)(()=>{W&&(I(W.title),O(x(new Date(W.scheduledAt))),A(W.prizes))},[W]);let Y=R.some(e=>!e.title.trim()||e.rankFrom<1||e.rankTo<e.rankFrom),G=(0,r.useMemo)(()=>{let e=[];for(let t of R)for(let a=t.rankFrom;a<=t.rankTo;a+=1)e.push(a);return e},[R]),X=(0,r.useMemo)(()=>new Set(G).size!==G.length,[G]),$=(0,r.useMemo)(()=>G.length,[G]),q=!!M&&L.trim().length>=3&&!X&&!Y&&!y&&!W,K=!!W&&!!M&&L.trim().length>=3&&!X&&!Y&&!y;async function Q(){if(!q){u.ZP.error("فرم قرعه کشي کامل و معتبر نيست");return}v(!0);try{await (0,h.Nv)("/admin/slide/draws",{method:"POST",body:JSON.stringify({title:L,scheduledAt:new Date(M).toISOString(),prizes:R.map(e=>({...e,title:e.title.trim(),amount:e.amount&&e.amount>0?e.amount:void 0}))})}),u.ZP.success("قرعه کشي اسلايد زمان بندي شد"),await J()}catch(e){u.ZP.error(e instanceof Error?e.message:"خطا در ايجاد قرعه کشي")}finally{v(!1)}}async function ee(){if(!W||!K){u.ZP.error("تنظيمات قابل ذخيره نيست");return}v(!0);try{await (0,h.Nv)("/admin/slide/draws/".concat(W.id),{method:"PUT",body:JSON.stringify({title:L,scheduledAt:new Date(M).toISOString(),prizes:R.map(e=>({...e,title:e.title.trim(),amount:e.amount&&e.amount>0?e.amount:void 0}))})}),u.ZP.success("تنظيمات قرعه کشي بروزرساني شد"),await J()}catch(e){u.ZP.error(e instanceof Error?e.message:"خطا در بروزرساني قرعه کشي")}finally{v(!1)}}async function et(e){k(e);try{let t=await (0,h.Nv)("/admin/slide/draws/".concat(e),{method:"DELETE"});u.ZP.success("قرعه حذف شد (بازگشت شانس: ".concat(t.refundedChances.toLocaleString("fa-IR"),")")),await J()}catch(e){u.ZP.error(e instanceof Error?e.message:"حذف قرعه انجام نشد")}finally{k(null)}}async function ea(e){N(e);try{await (0,h.Nv)("/admin/slide/draws/".concat(e,"/run"),{method:"POST"}),u.ZP.success("قرعه کشي اجرا شد"),await J()}catch(e){u.ZP.error(e instanceof Error?e.message:"خطا در اجراي قرعه کشي")}finally{N(null)}}async function en(e){let t=E[e];if(t)return t;let a=await (0,h.Nv)("/admin/slide/draws/".concat(e,"/log"),{method:"GET"});return P(t=>({...t,[e]:a})),a}async function er(e){if(C===e){Z(null);return}try{await en(e),Z(e)}catch(e){u.ZP.error(e instanceof Error?e.message:"خطا در دريافت لاگ")}}async function es(e){T(e);try{let t=await en(e),a=new Date().toISOString().replace(/[:.]/g,"-");!function(e,t){let a=new Blob([JSON.stringify(t,null,2)],{type:"application/json;charset=utf-8"}),n=URL.createObjectURL(a),r=document.createElement("a");r.href=n,r.download=e,document.body.appendChild(r),r.click(),r.remove(),URL.revokeObjectURL(n)}("slide-draw-log-".concat(e,"-").concat(a,".json"),t),u.ZP.success("لاگ کامل دانلود شد")}catch(e){u.ZP.error(e instanceof Error?e.message:"دانلود لاگ انجام نشد")}finally{T(null)}}function ei(e){O(x(new Date(Date.now()+6e4*e)))}let el=(0,r.useMemo)(()=>p.filter(e=>"drawn"===e.status),[p]);return(0,n.jsxs)("div",{className:"space-y-8",dir:"rtl",children:[(0,n.jsx)("h1",{className:"text-3xl font-black",children:"قرعه کشي اسلايد (امن و قابل راستي آزمايي)"}),(0,n.jsxs)("section",{className:"card glass p-6 space-y-4",children:[(0,n.jsx)("h2",{className:"text-xl font-black",children:"کنترل لحظه ای بازی"}),(0,n.jsxs)("div",{className:"grid md:grid-cols-2 gap-4",children:[(0,n.jsxs)("div",{className:"space-y-2",children:[(0,n.jsx)("label",{className:"text-xs text-white/60 block",children:"درجه سختی ماشین اسلاید (0 تا 100)"}),(0,n.jsx)("input",{type:"range",min:0,max:100,value:_,onChange:e=>D(Number(e.target.value)),className:"w-full"}),(0,n.jsxs)("p",{className:"text-sm text-white/70",children:["مقدار فعلی: ",_]}),(0,n.jsx)("button",{onClick:B,className:"btn-secondary",children:"ذخیره سختی"})]}),(0,n.jsxs)("div",{className:"space-y-2",children:[(0,n.jsx)("label",{className:"text-xs text-white/60 block",children:"عدد برنده روزانه (1 تا 100)"}),(0,n.jsx)("input",{type:"date",value:U,onChange:e=>F(e.target.value),className:"w-full bg-white/5 border border-white/10 rounded-lg px-3 py-2"}),(0,n.jsx)("input",{type:"number",min:1,max:100,value:z,onChange:e=>H(Number(e.target.value)),className:"w-full bg-white/5 border border-white/10 rounded-lg px-3 py-2"}),(0,n.jsx)("button",{onClick:V,className:"btn-primary",children:"ثبت عدد روزانه"})]})]})]}),(0,n.jsxs)("section",{className:"card glass p-6 space-y-4",children:[(0,n.jsx)("h2",{className:"text-xl font-black",children:W?"ويرايش قرعه کشي زمان بندي شده":"تنظيم قرعه کشي جديد"}),(0,n.jsxs)("div",{className:"grid md:grid-cols-2 gap-4",children:[(0,n.jsxs)("div",{children:[(0,n.jsx)("label",{className:"text-xs text-white/60 mb-1 block",children:"عنوان"}),(0,n.jsx)("input",{value:L,onChange:e=>I(e.target.value),className:"w-full bg-white/5 border border-white/10 rounded-lg px-3 py-2"})]}),(0,n.jsxs)("div",{children:[(0,n.jsx)("label",{className:"text-xs text-white/60 mb-1 block",children:"زمان اجرا"}),(0,n.jsx)("input",{type:"datetime-local",value:M,onChange:e=>O(e.target.value),className:"w-full bg-white/5 border border-white/10 rounded-lg px-3 py-2"}),(0,n.jsxs)("div",{className:"flex gap-2 mt-2",children:[(0,n.jsx)("button",{onClick:()=>ei(10),className:"px-2 py-1 rounded bg-white/10 text-xs",children:"+10 دقيقه"}),(0,n.jsx)("button",{onClick:()=>ei(30),className:"px-2 py-1 rounded bg-white/10 text-xs",children:"+30 دقيقه"}),(0,n.jsx)("button",{onClick:()=>ei(60),className:"px-2 py-1 rounded bg-white/10 text-xs",children:"+1 ساعت"})]})]})]}),(0,n.jsxs)("div",{className:"flex items-center justify-between mt-2",children:[(0,n.jsx)("h3",{className:"font-bold",children:"جوايز (پشتيباني از بازه رتبه)"}),(0,n.jsxs)("button",{onClick:function(){let e=R.length?Math.max(...R.map(e=>e.rankTo)):0;A(t=>[...t,{rankFrom:e+1,rankTo:e+1,title:"جايزه جديد",amount:0}])},className:"btn-secondary",children:[(0,n.jsx)(s.Z,{className:"w-4 h-4"}),"افزودن جايزه"]})]}),(0,n.jsx)("div",{className:"space-y-2",children:R.map((e,t)=>{var a;return(0,n.jsxs)("div",{className:"grid grid-cols-12 gap-2",children:[(0,n.jsx)("input",{type:"number",min:1,value:e.rankFrom,onChange:e=>A(a=>a.map((a,n)=>n===t?{...a,rankFrom:Number(e.target.value)}:a)),className:"col-span-2 bg-white/5 border border-white/10 rounded-lg px-2 py-2"}),(0,n.jsx)("input",{type:"number",min:1,value:e.rankTo,onChange:e=>A(a=>a.map((a,n)=>n===t?{...a,rankTo:Number(e.target.value)}:a)),className:"col-span-2 bg-white/5 border border-white/10 rounded-lg px-2 py-2"}),(0,n.jsx)("input",{value:e.title,onChange:e=>A(a=>a.map((a,n)=>n===t?{...a,title:e.target.value}:a)),className:"col-span-4 bg-white/5 border border-white/10 rounded-lg px-2 py-2"}),(0,n.jsx)("input",{type:"number",value:null!==(a=e.amount)&&void 0!==a?a:0,onChange:e=>A(a=>a.map((a,n)=>n===t?{...a,amount:Number(e.target.value)}:a)),className:"col-span-3 bg-white/5 border border-white/10 rounded-lg px-2 py-2"}),(0,n.jsx)("button",{onClick:()=>{A(e=>e.filter((e,a)=>a!==t))},className:"col-span-1 rounded-lg border border-rose-500/30 text-rose-400 hover:bg-rose-500/10",children:(0,n.jsx)(i.Z,{className:"w-4 h-4 mx-auto"})})]},t)})}),(0,n.jsxs)("div",{className:"text-xs text-white/60 space-y-1",children:[(0,n.jsxs)("p",{children:["تعداد کل برنده ها براساس بازه ها: ",(0,n.jsx)("span",{className:"font-bold text-accent-gold",children:$.toLocaleString("fa-IR")})]}),X?(0,n.jsx)("p",{className:"text-rose-400",children:"بازه رتبه ها با هم تداخل دارند."}):null,Y?(0,n.jsx)("p",{className:"text-rose-400",children:"عنوان جايزه يا بازه رتبه معتبر نيست."}):null]}),(0,n.jsx)("div",{className:"flex flex-wrap gap-3",children:W?(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)("button",{onClick:ee,disabled:!K,className:"btn-primary disabled:opacity-60",children:[(0,n.jsx)(l.Z,{className:"w-4 h-4"}),y?"در حال ذخيره...":"ذخيره تغييرات قرعه"]}),(0,n.jsxs)("button",{onClick:()=>void et(W.id),disabled:j===W.id,className:"btn-secondary border-rose-500/30 text-rose-300 hover:bg-rose-500/10 disabled:opacity-60",children:[(0,n.jsx)(i.Z,{className:"w-4 h-4"}),j===W.id?"در حال حذف...":"حذف قرعه جاري"]})]}):(0,n.jsx)("button",{onClick:Q,disabled:!q,className:"btn-primary disabled:opacity-60",children:y?"در حال ثبت...":"ثبت زمان قرعه کشي"})})]}),(0,n.jsxs)("section",{className:"card glass p-6",children:[(0,n.jsxs)("h2",{className:"text-xl font-black mb-4 flex items-center gap-2",children:[(0,n.jsx)(c.Z,{className:"text-accent-gold"}),"پيش نمايش مشارکت"]}),(0,n.jsxs)("div",{className:"grid md:grid-cols-3 gap-3 mb-3",children:[(0,n.jsxs)("div",{className:"bg-white/5 border border-white/10 rounded-xl p-3",children:[(0,n.jsx)("p",{className:"text-xs text-white/50",children:"تعداد شرکت کنندگان"}),(0,n.jsx)("p",{className:"font-black",children:(null!==(e=null==g?void 0:g.totalParticipants)&&void 0!==e?e:0).toLocaleString("fa-IR")})]}),(0,n.jsxs)("div",{className:"bg-white/5 border border-white/10 rounded-xl p-3",children:[(0,n.jsx)("p",{className:"text-xs text-white/50",children:"جمع شانس ها"}),(0,n.jsx)("p",{className:"font-black",children:(null!==(t=null==g?void 0:g.totalChances)&&void 0!==t?t:0).toLocaleString("fa-IR")})]}),(0,n.jsxs)("div",{className:"bg-white/5 border border-white/10 rounded-xl p-3",children:[(0,n.jsx)("p",{className:"text-xs text-white/50",children:"کاربران قابل انتخاب"}),(0,n.jsxs)("p",{className:"font-black",children:[(null!==(a=null==g?void 0:g.topParticipants.length)&&void 0!==a?a:0).toLocaleString("fa-IR"),"+"]})]})]})]}),W?(0,n.jsxs)("section",{className:"card glass p-6",children:[(0,n.jsx)("h2",{className:"text-xl font-black mb-2",children:"قرعه کشي فعال بعدي"}),(0,n.jsx)("p",{className:"text-sm text-white/70",children:W.title}),(0,n.jsxs)("p",{className:"text-sm text-white/70 mt-1",children:["زمان: ",new Date(W.scheduledAt).toLocaleString("fa-IR")]}),(0,n.jsxs)("button",{onClick:()=>ea(W.id),disabled:w===W.id,className:"btn-secondary mt-4 disabled:opacity-60",children:[(0,n.jsx)(o,{className:"w-4 h-4"}),w===W.id?"در حال اجرا...":"اجراي قرعه (پس از رسيدن زمان)"]})]}):null,(0,n.jsxs)("section",{className:"card glass p-6",children:[(0,n.jsx)("h2",{className:"text-xl font-black mb-4",children:"تاريخچه قرعه کشي اسلايد و لاگ قابل ذخيره"}),(0,n.jsxs)("div",{className:"space-y-4",children:[el.map(e=>{var t,a,r,s,i,l;let c=C===e.id,o=E[e.id];return(0,n.jsxs)("div",{className:"p-4 border border-white/10 rounded-xl bg-black/20",children:[(0,n.jsxs)("div",{className:"flex flex-wrap items-center justify-between gap-3",children:[(0,n.jsxs)("div",{children:[(0,n.jsx)("p",{className:"font-bold",children:e.title}),(0,n.jsx)("p",{className:"text-xs text-white/60 mt-1",children:new Date(e.scheduledAt).toLocaleString("fa-IR")}),void 0!==e.targetNumber?(0,n.jsxs)("p",{className:"text-sm mt-2",children:["شماره هدف: ",(0,n.jsx)("span",{className:"text-accent-gold font-black",children:e.targetNumber.toLocaleString("fa-IR")})]}):null]}),(0,n.jsxs)("div",{className:"flex gap-2",children:[(0,n.jsx)("button",{onClick:()=>void er(e.id),className:"btn-secondary text-xs px-4 py-2",children:c?"بستن جزئيات":"مشاهده جزئيات"}),(0,n.jsxs)("button",{onClick:()=>void es(e.id),disabled:S===e.id,className:"btn-secondary text-xs px-4 py-2 disabled:opacity-60",children:[(0,n.jsx)(d.Z,{className:"w-4 h-4"}),S===e.id?"در حال دانلود...":"دانلود لاگ کامل"]})]})]}),c&&o?(0,n.jsxs)("div",{className:"mt-4 space-y-4",children:[(0,n.jsxs)("div",{className:"grid md:grid-cols-3 gap-3",children:[(0,n.jsxs)("div",{className:"bg-white/5 border border-white/10 rounded-lg p-3",children:[(0,n.jsx)("p",{className:"text-xs text-white/50",children:"تعداد شماره هاي ثبت شده"}),(0,n.jsx)("p",{className:"font-black",children:o.summary.totalEntries.toLocaleString("fa-IR")})]}),(0,n.jsxs)("div",{className:"bg-white/5 border border-white/10 rounded-lg p-3",children:[(0,n.jsx)("p",{className:"text-xs text-white/50",children:"تعداد شرکت کنندگان"}),(0,n.jsx)("p",{className:"font-black",children:o.summary.totalParticipants.toLocaleString("fa-IR")})]}),(0,n.jsxs)("div",{className:"bg-white/5 border border-white/10 rounded-lg p-3",children:[(0,n.jsx)("p",{className:"text-xs text-white/50",children:"تعداد برندگان"}),(0,n.jsx)("p",{className:"font-black",children:o.summary.totalWinners.toLocaleString("fa-IR")})]})]}),(0,n.jsx)("div",{className:"overflow-x-auto border border-white/10 rounded-lg",children:(0,n.jsxs)("table",{className:"min-w-full text-sm",children:[(0,n.jsx)("thead",{className:"bg-white/5 text-white/60",children:(0,n.jsxs)("tr",{children:[(0,n.jsx)("th",{className:"px-3 py-2 text-right",children:"رتبه"}),(0,n.jsx)("th",{className:"px-3 py-2 text-right",children:"شماره برنده"}),(0,n.jsx)("th",{className:"px-3 py-2 text-right",children:"برنده"}),(0,n.jsx)("th",{className:"px-3 py-2 text-right",children:"جايزه"})]})}),(0,n.jsx)("tbody",{children:o.winners.map(t=>(0,n.jsxs)("tr",{className:"border-t border-white/10",children:[(0,n.jsx)("td",{className:"px-3 py-2 font-bold",children:t.rank.toLocaleString("fa-IR")}),(0,n.jsx)("td",{className:"px-3 py-2 font-mono text-cyan-300",children:t.winningNumber.toLocaleString("fa-IR")}),(0,n.jsx)("td",{className:"px-3 py-2",children:t.fullName||t.userEmail}),(0,n.jsxs)("td",{className:"px-3 py-2",children:[t.prize.title,t.prize.amount?" - ".concat((0,m.d)(t.prize.amount)):""]})]},"".concat(e.id,"-").concat(t.rank)))})]})}),(0,n.jsxs)("div",{className:"text-xs text-white/60 space-y-1",children:[(0,n.jsxs)("p",{children:["الگوريتم: ",(0,n.jsx)("span",{className:"font-mono",children:null!==(s=null===(t=o.draw.proof)||void 0===t?void 0:t.algorithm)&&void 0!==s?s:"n/a"})]}),(0,n.jsxs)("p",{children:["هش شرکت کنندگان: ",(0,n.jsx)("span",{className:"font-mono break-all",children:null!==(i=null===(a=o.draw.proof)||void 0===a?void 0:a.participantsHash)&&void 0!==i?i:"n/a"})]}),(0,n.jsxs)("p",{children:["Entropy: ",(0,n.jsx)("span",{className:"font-mono break-all",children:null!==(l=null===(r=o.draw.proof)||void 0===r?void 0:r.externalEntropy)&&void 0!==l?l:"n/a"})]})]})]}):null]},e.id)}),el.length?null:(0,n.jsx)("p",{className:"text-sm text-white/50",children:"هنوز قرعه کشي انجام شده اي وجود ندارد."})]})]})]})}},1837:function(e,t,a){"use strict";a.d(t,{Je:function(){return u},Nv:function(){return x},c8:function(){return p},hP:function(){return o},vD:function(){return d}});var n,r=a(257);let s=null!==(n=r.env.NEXT_PUBLIC_API_URL)&&void 0!==n?n:"http://localhost:4000/api/v1",i=r.env.NEXT_PUBLIC_API_GATEWAY_KEY,l="car_access_token",c="car_refresh_token";function o(){return localStorage.getItem(l)}function d(e){localStorage.setItem(l,e.accessToken),localStorage.setItem(c,e.refreshToken)}function u(){localStorage.removeItem(l),localStorage.removeItem(c)}async function h(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},a=arguments.length>2?arguments[2]:void 0,n=new Headers(t.headers);void 0!==t.body&&null!==t.body&&n.set("Content-Type","application/json"),i&&n.set("x-api-gateway-key",i),a&&n.set("Authorization","Bearer ".concat(a));let r=await fetch("".concat(s).concat(e),{...t,headers:n});if(!r.ok){var l,c;let e=await r.json().catch(()=>({}));throw Error(null!==(c=null!==(l=e.error)&&void 0!==l?l:e.message)&&void 0!==c?c:"HTTP_".concat(r.status))}return 204===r.status?{}:await r.json()}async function m(){let e=localStorage.getItem(c);if(!e)return null;try{let t=await h("/auth/refresh",{method:"POST",body:JSON.stringify({refreshToken:e})});return d(t),t.accessToken}catch(e){return u(),null}}async function x(e){var t;let a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{auth:!0},r=null===(t=n.auth)||void 0===t||t,s=r?o():void 0;try{return await h(e,a,null!=s?s:void 0)}catch(n){if(!r)throw n;let t=await m();if(!t)throw n;return h(e,a,t)}}function p(){return"undefined"!=typeof crypto&&"randomUUID"in crypto?crypto.randomUUID():"idemp-".concat(Date.now(),"-").concat(Math.random().toString(16).slice(2))}},7921:function(e,t,a){"use strict";function n(e){return(Number.isFinite(e)?Math.trunc(e):0).toLocaleString("fa-IR")}function r(e){if(!e.trim())return null;let t=e.split("").map(e=>{let t="۰۱۲۳۴۵۶۷۸۹".indexOf(e);if(t>=0)return String(t);let a="٠١٢٣٤٥٦٧٨٩".indexOf(e);return a>=0?String(a):e}).join("").toLowerCase().replace(/,/g,"").trim(),a=t.includes("million")||t.includes("میلیون")||/\d+(\.\d+)?\s*m\b/.test(t),n=Number(t.replace(/[^\d.]/g,""));if(!Number.isFinite(n)||n<=0)return null;let r=Math.trunc(a?1e6*n:n);return r<=0?null:r}a.d(t,{C:function(){return r},d:function(){return n}})}},function(e){e.O(0,[5186,2971,2117,1744],function(){return e(e.s=5328)}),_N_E=e.O()}]);