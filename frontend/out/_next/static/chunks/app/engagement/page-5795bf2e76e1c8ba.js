(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[3098],{2458:function(e,s,a){Promise.resolve().then(a.bind(a,8538))},8538:function(e,s,a){"use strict";a.r(s),a.d(s,{default:function(){return r}});var t=a(7437),c=a(2265),n=a(5186),l=a(1837),i=a(7766);function r(){var e,s,a,r,d,o,m;let{refreshMe:h}=(0,i.a)(),[u,x]=(0,c.useState)(null),[g,N]=(0,c.useState)(null),[p,v]=(0,c.useState)([]),[y,b]=(0,c.useState)([]),[f,j]=(0,c.useState)([]),[k,w]=(0,c.useState)("");async function P(){try{let[e,s,a,t,c]=await Promise.all([(0,l.Nv)("/engagement/dashboard"),(0,l.Nv)("/engagement/missions/today"),(0,l.Nv)("/engagement/achievements"),(0,l.Nv)("/engagement/events/weekly",{method:"GET"},{auth:!1}),(0,l.Nv)("/engagement/shock-prizes",{method:"GET"},{auth:!1})]);x(e),N(s.mission),v(a.unlocked),b(t.items),j(c.items)}catch(e){n.ZP.error(e instanceof Error?e.message:"خطا در دریافت اطلاعات کمپین")}}async function S(e){try{await (0,l.Nv)("/engagement/welcome/claim",{method:"POST",body:JSON.stringify({action:e})}),n.ZP.success("جایزه خوشامدگویی ثبت شد"),await h(),await P()}catch(e){n.ZP.error(e instanceof Error?e.message:"ثبت جایزه ناموفق بود")}}async function C(){try{let e=await (0,l.Nv)("/engagement/quick-hit/play",{method:"POST",body:JSON.stringify({mode:"standard"})});w("".concat(e.outcome.join(" ")," | ").concat(e.reward.type,":").concat(e.reward.value)),n.ZP.success(e.guaranteed?"برد تضمینی فعال شد":"ضربه فوری اجرا شد"),await h(),await P()}catch(e){n.ZP.error(e instanceof Error?e.message:"بازی انجام نشد")}}async function O(){try{await (0,l.Nv)("/engagement/streak/checkin",{method:"POST"}),n.ZP.success("استریک روزانه ثبت شد"),await h(),await P()}catch(e){n.ZP.error(e instanceof Error?e.message:"استریک ثبت نشد")}}async function T(e){try{await (0,l.Nv)("/engagement/missions/complete",{method:"POST",body:JSON.stringify({code:e})}),n.ZP.success("ماموریت ثبت شد"),await h(),await P()}catch(e){n.ZP.error(e instanceof Error?e.message:"ماموریت ناموفق بود")}}return(0,c.useEffect)(()=>{P()},[]),(0,t.jsx)("main",{className:"min-h-screen pt-28 pb-16",dir:"rtl",children:(0,t.jsxs)("div",{className:"max-w-6xl mx-auto px-4 space-y-6",children:[(0,t.jsxs)("section",{className:"card glass p-8",children:[(0,t.jsx)("h1",{className:"text-4xl font-black mb-2",children:"مرکز جذب کاربر و هیجان"}),(0,t.jsx)("p",{className:"text-white/70",children:"Welcome Bomb، بازی های فوری، استریک، ماموریت روزانه، دستاوردها، VIP و رویدادهای هفتگی."})]}),(0,t.jsxs)("section",{className:"grid md:grid-cols-4 gap-3",children:[(0,t.jsxs)("div",{className:"card glass p-4",children:["مجموع برد: ",null!==(a=null==u?void 0:null===(e=u.totalWonIrr)||void 0===e?void 0:e.toLocaleString("fa-IR"))&&void 0!==a?a:0]}),(0,t.jsxs)("div",{className:"card glass p-4",children:["VIP: ",null!==(r=null==u?void 0:null===(s=u.vip)||void 0===s?void 0:s.name)&&void 0!==r?r:"-"]}),(0,t.jsxs)("div",{className:"card glass p-4",children:["زیرمجموعه فعال: ",null!==(d=null==u?void 0:u.activeReferrals)&&void 0!==d?d:0]}),(0,t.jsxs)("div",{className:"card glass p-4",children:["تا VIP بعدی: ",null!==(o=null==u?void 0:u.chancesToNextVip)&&void 0!==o?o:0]})]}),(0,t.jsxs)("section",{className:"card glass p-6 space-y-3",children:[(0,t.jsx)("h2",{className:"text-2xl font-black",children:"Welcome Bomb"}),(0,t.jsxs)("div",{className:"grid md:grid-cols-4 gap-2",children:[(0,t.jsx)("button",{onClick:()=>S("register"),className:"btn-secondary",children:"ثبت نام +5 شانس"}),(0,t.jsx)("button",{onClick:()=>S("profile"),className:"btn-secondary",children:"تکمیل پروفایل +2 +50 سوت"}),(0,t.jsx)("button",{onClick:()=>S("phone"),className:"btn-secondary",children:"تایید موبایل +1"}),(0,t.jsx)("button",{onClick:()=>S("app"),className:"btn-secondary",children:"دانلود اپ +3 +بونوس"})]})]}),(0,t.jsxs)("section",{className:"grid md:grid-cols-2 gap-4",children:[(0,t.jsxs)("div",{className:"card glass p-6 space-y-3",children:[(0,t.jsx)("h2",{className:"text-2xl font-black",children:"Quick Hit"}),(0,t.jsx)("button",{onClick:C,className:"btn-primary",children:"اجرا با 1 شانس"}),(0,t.jsx)("p",{className:"text-sm text-white/70",children:k||"هر 10 بازی یک برد تضمینی"})]}),(0,t.jsxs)("div",{className:"card glass p-6 space-y-3",children:[(0,t.jsx)("h2",{className:"text-2xl font-black",children:"Daily Streak"}),(0,t.jsx)("button",{onClick:O,className:"btn-primary",children:"ثبت امروز"}),(0,t.jsx)("p",{className:"text-sm text-white/70",children:"روز 1 تا 7 جایزه پلکانی، روز از دست برود ریست می شود."})]})]}),(0,t.jsxs)("section",{className:"card glass p-6",children:[(0,t.jsx)("h2",{className:"text-2xl font-black mb-3",children:"ماموریت های روزانه"}),(0,t.jsx)("div",{className:"grid md:grid-cols-3 gap-2",children:(null!==(m=null==g?void 0:g.missions)&&void 0!==m?m:[]).map(e=>(0,t.jsxs)("button",{onClick:()=>T(e.code),className:"btn-secondary disabled:opacity-60",disabled:e.done,children:[e.code," | پاداش ",e.rewardValue]},e.code))})]}),(0,t.jsxs)("section",{className:"grid md:grid-cols-2 gap-4",children:[(0,t.jsxs)("div",{className:"card glass p-6",children:[(0,t.jsx)("h2",{className:"text-2xl font-black mb-3",children:"دستاوردها"}),(0,t.jsxs)("div",{className:"space-y-2 text-sm",children:[p.map(e=>(0,t.jsx)("p",{children:e},e)),p.length?null:(0,t.jsx)("p",{className:"text-white/60",children:"هنوز دستاوردی باز نشده است."})]})]}),(0,t.jsxs)("div",{className:"card glass p-6",children:[(0,t.jsx)("h2",{className:"text-2xl font-black mb-3",children:"جایزه های شوکه کننده"}),(0,t.jsx)("div",{className:"space-y-2 text-sm",children:f.map(e=>(0,t.jsxs)("p",{children:[(0,t.jsxs)("b",{children:[e.title,":"]})," ",e.description]},e.code))})]})]}),(0,t.jsxs)("section",{className:"card glass p-6",children:[(0,t.jsx)("h2",{className:"text-2xl font-black mb-3",children:"رویداد هفتگی"}),(0,t.jsx)("div",{className:"grid md:grid-cols-2 gap-2 text-sm",children:y.map(e=>(0,t.jsxs)("div",{className:"rounded-lg border border-white/10 bg-black/20 p-3",children:[(0,t.jsxs)("p",{children:[(0,t.jsx)("b",{children:e.day})," - ",e.title]}),(0,t.jsx)("p",{className:"text-white/70",children:e.prize}),(0,t.jsx)("p",{className:"text-white/60",children:e.hook})]},"".concat(e.day,"-").concat(e.title)))})]})]})})}},7766:function(e,s,a){"use strict";a.d(s,{H:function(){return d},a:function(){return o}});var t=a(7437),c=a(2265),n=a(1837),l=a(5572);let i=(0,c.createContext)(null);async function r(){return(0,n.Nv)("/me",{method:"GET"},{auth:!0})}function d(e){let{children:s}=e,[a,d]=(0,c.useState)(null),[o,m]=(0,c.useState)(!0),h=(0,c.useCallback)(async()=>{try{let e=await r();d(e)}catch(e){d(null)}},[]);(0,c.useEffect)(()=>{let e=!0;return(async()=>{try{let s=await r();e&&d(s)}catch(s){e&&d(null)}finally{e&&m(!1)}})(),()=>{e=!1}},[]);let u=(0,c.useCallback)(async e=>{let{email:s,password:a}=e,t=await (0,n.Nv)("/auth/login",{method:"POST",body:JSON.stringify({email:s,password:a})},{auth:!1});return(0,n.vD)({accessToken:t.accessToken,refreshToken:t.refreshToken}),(0,l.DM)(t.user),d(t.user),t.user},[]),x=(0,c.useCallback)(async e=>{let{email:s,password:a,referralCode:t}=e;await (0,n.Nv)("/auth/register",{method:"POST",body:JSON.stringify({email:s,password:a,referralCode:t})},{auth:!1})},[]),g=(0,c.useCallback)(async()=>{try{await (0,n.Nv)("/auth/logout",{method:"POST",body:JSON.stringify({})})}catch(e){}finally{(0,n.Je)(),(0,l.DM)(null),d(null)}},[]),N=(0,c.useMemo)(()=>({user:a,isLoading:o,isAuthenticated:!!a,login:u,register:x,logout:g,refreshMe:h}),[a,o,u,x,g,h]);return(0,t.jsx)(i.Provider,{value:N,children:s})}function o(){let e=(0,c.useContext)(i);if(!e)throw Error("useAuth must be used within AuthProvider");return e}}},function(e){e.O(0,[5186,1837,2971,2117,1744],function(){return e(e.s=2458)}),_N_E=e.O()}]);