(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[6520],{46:function(t,e,n){Promise.resolve().then(n.bind(n,9550))},257:function(t,e,n){"use strict";var r,o;t.exports=(null==(r=n.g.process)?void 0:r.env)&&"object"==typeof(null==(o=n.g.process)?void 0:o.env)?n.g.process:n(4227)},4227:function(t){!function(){var e={229:function(t){var e,n,r,o=t.exports={};function i(){throw Error("setTimeout has not been defined")}function c(){throw Error("clearTimeout has not been defined")}function s(t){if(e===setTimeout)return setTimeout(t,0);if((e===i||!e)&&setTimeout)return e=setTimeout,setTimeout(t,0);try{return e(t,0)}catch(n){try{return e.call(null,t,0)}catch(n){return e.call(this,t,0)}}}!function(){try{e="function"==typeof setTimeout?setTimeout:i}catch(t){e=i}try{n="function"==typeof clearTimeout?clearTimeout:c}catch(t){n=c}}();var a=[],l=!1,u=-1;function d(){l&&r&&(l=!1,r.length?a=r.concat(a):u=-1,a.length&&h())}function h(){if(!l){var t=s(d);l=!0;for(var e=a.length;e;){for(r=a,a=[];++u<e;)r&&r[u].run();u=-1,e=a.length}r=null,l=!1,function(t){if(n===clearTimeout)return clearTimeout(t);if((n===c||!n)&&clearTimeout)return n=clearTimeout,clearTimeout(t);try{n(t)}catch(e){try{return n.call(null,t)}catch(e){return n.call(this,t)}}}(t)}}function f(t,e){this.fun=t,this.array=e}function m(){}o.nextTick=function(t){var e=Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)e[n-1]=arguments[n];a.push(new f(t,e)),1!==a.length||l||s(h)},f.prototype.run=function(){this.fun.apply(null,this.array)},o.title="browser",o.browser=!0,o.env={},o.argv=[],o.version="",o.versions={},o.on=m,o.addListener=m,o.once=m,o.off=m,o.removeListener=m,o.removeAllListeners=m,o.emit=m,o.prependListener=m,o.prependOnceListener=m,o.listeners=function(t){return[]},o.binding=function(t){throw Error("process.binding is not supported")},o.cwd=function(){return"/"},o.chdir=function(t){throw Error("process.chdir is not supported")},o.umask=function(){return 0}}},n={};function r(t){var o=n[t];if(void 0!==o)return o.exports;var i=n[t]={exports:{}},c=!0;try{e[t](i,i.exports,r),c=!1}finally{c&&delete n[t]}return i.exports}r.ab="//";var o=r(229);t.exports=o}()},9550:function(t,e,n){"use strict";n.r(e),n.d(e,{default:function(){return s}});var r=n(7437),o=n(2265),i=n(5186),c=n(1837);function s(){let[t,e]=(0,o.useState)([]);async function n(){try{let t=await (0,c.Nv)("/showroom/vehicles",{method:"GET"},{auth:!1});e(t.items)}catch(t){i.ZP.error(t instanceof Error?t.message:"خطا در دریافت خودروها")}}async function s(t,e){try{await (0,c.Nv)("/showroom/vehicles/".concat(t,"/orders"),{method:"POST",body:JSON.stringify({paymentAsset:e})}),i.ZP.success("سفارش خودرو ثبت شد"),await n()}catch(t){i.ZP.error(t instanceof Error?t.message:"ثبت سفارش ناموفق بود")}}return(0,o.useEffect)(()=>{n()},[]),(0,r.jsx)("main",{className:"min-h-screen pt-28 pb-16",dir:"rtl",children:(0,r.jsxs)("div",{className:"max-w-6xl mx-auto px-4 space-y-6",children:[(0,r.jsxs)("section",{className:"card glass p-8",children:[(0,r.jsx)("h1",{className:"text-4xl font-black mb-2",children:"نمایشگاه خودرو (Showroom)"}),(0,r.jsx)("p",{className:"text-white/70",children:"خرید با تومان یا طلای آب شده؛ خودروهای برد شده دوباره در نمایشگاه قابل خرید هستند."})]}),(0,r.jsxs)("section",{className:"grid md:grid-cols-2 gap-4",children:[t.map(t=>{var e,n,o,i,c,a;let l=String(null!==(o=t.vehicle.title)&&void 0!==o?o:"خودرو ".concat(t.id)),u=String(null!==(i=t.vehicle.imageUrl)&&void 0!==i?i:"https://images.unsplash.com/photo-1503376780353-7e6692767b70?q=80&w=1200");return(0,r.jsxs)("div",{className:"card glass p-5 space-y-3",children:[(0,r.jsx)("img",{src:u,alt:l,className:"w-full h-48 object-cover rounded-xl"}),(0,r.jsx)("h3",{className:"text-2xl font-black",children:l}),(0,r.jsxs)("p",{className:"text-sm text-white/60",children:["نوع منبع: ","lottery_winback"===t.sourceType?"بازخرید از برنده":"خرید مستقیم سایت"]}),(0,r.jsxs)("p",{className:"text-sm",children:["قیمت تومان: ",null!==(c=null===(e=t.listedPriceIrr)||void 0===e?void 0:e.toLocaleString("fa-IR"))&&void 0!==c?c:"-"]}),(0,r.jsxs)("p",{className:"text-sm",children:["قیمت سوت: ",null!==(a=null===(n=t.listedPriceGoldSot)||void 0===n?void 0:n.toLocaleString("fa-IR"))&&void 0!==a?a:"-"]}),(0,r.jsxs)("div",{className:"flex gap-2",children:[(0,r.jsx)("button",{disabled:!t.listedPriceIrr,onClick:()=>s(t.id,"IRR"),className:"btn-primary disabled:opacity-60",children:"خرید با تومان"}),(0,r.jsx)("button",{disabled:!t.listedPriceGoldSot,onClick:()=>s(t.id,"GOLD_SOT"),className:"btn-secondary disabled:opacity-60",children:"خرید با سوت"})]})]},t.id)}),t.length?null:(0,r.jsx)("p",{className:"text-white/60",children:"خودروی فعال در نمایشگاه وجود ندارد."})]})]})})}},1837:function(t,e,n){"use strict";n.d(e,{Je:function(){return d},Nv:function(){return m},c8:function(){return p},hP:function(){return l},vD:function(){return u}});var r,o=n(257);let i=null!==(r=o.env.NEXT_PUBLIC_API_URL)&&void 0!==r?r:"http://localhost:4000/api/v1",c=o.env.NEXT_PUBLIC_API_GATEWAY_KEY,s="car_access_token",a="car_refresh_token";function l(){return localStorage.getItem(s)}function u(t){localStorage.setItem(s,t.accessToken),localStorage.setItem(a,t.refreshToken)}function d(){localStorage.removeItem(s),localStorage.removeItem(a)}async function h(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2?arguments[2]:void 0,r=new Headers(e.headers);void 0!==e.body&&null!==e.body&&r.set("Content-Type","application/json"),c&&r.set("x-api-gateway-key",c),n&&r.set("Authorization","Bearer ".concat(n));let o=await fetch("".concat(i).concat(t),{...e,headers:r});if(!o.ok){var s,a;let t=await o.json().catch(()=>({}));throw Error(null!==(a=null!==(s=t.error)&&void 0!==s?s:t.message)&&void 0!==a?a:"HTTP_".concat(o.status))}return 204===o.status?{}:await o.json()}async function f(){let t=localStorage.getItem(a);if(!t)return null;try{let e=await h("/auth/refresh",{method:"POST",body:JSON.stringify({refreshToken:t})});return u(e),e.accessToken}catch(t){return d(),null}}async function m(t){var e;let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{auth:!0},o=null===(e=r.auth)||void 0===e||e,i=o?l():void 0;try{return await h(t,n,null!=i?i:void 0)}catch(r){if(!o)throw r;let e=await f();if(!e)throw r;return h(t,n,e)}}function p(){return"undefined"!=typeof crypto&&"randomUUID"in crypto?crypto.randomUUID():"idemp-".concat(Date.now(),"-").concat(Math.random().toString(16).slice(2))}}},function(t){t.O(0,[5186,2971,2117,1744],function(){return t(t.s=46)}),_N_E=t.O()}]);