(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[1192],{9054:function(e,s,a){Promise.resolve().then(a.bind(a,133))},133:function(e,s,a){"use strict";a.r(s),a.d(s,{default:function(){return r}});var n=a(7437),t=a(2265),c=a(5186),i=a(1837);function r(){let[e,s]=(0,t.useState)([]),[a,r]=(0,t.useState)([]),[l,d]=(0,t.useState)([]),o=async()=>{try{let[e,a,n]=await Promise.all([(0,i.Nv)("/admin/finance/withdrawals"),(0,i.Nv)("/admin/loans"),(0,i.Nv)("/admin/system/backups")]);s(e.items),r(a.items),d(n.items)}catch(e){c.ZP.error(e instanceof Error?e.message:"خطا در دریافت اطلاعات مالی")}};(0,t.useEffect)(()=>{o()},[]);let m=(0,t.useMemo)(()=>{let s=e.filter(e=>"pending"===e.status),n=a.filter(e=>"pending"===e.status);return{pendingWCount:s.length,pendingWAmount:s.reduce((e,s)=>e+s.amount,0),pendingLCount:n.length,pendingLAmount:n.reduce((e,s)=>e+s.principalIrr,0)}},[e,a]);async function h(e){try{await (0,i.Nv)("/admin/finance/withdrawals/".concat(e,"/approve"),{method:"POST"}),c.ZP.success("برداشت تایید شد"),await o()}catch(e){c.ZP.error(e instanceof Error?e.message:"خطا")}}async function u(e){try{await (0,i.Nv)("/admin/finance/withdrawals/".concat(e,"/reject"),{method:"POST"}),c.ZP.success("برداشت رد شد"),await o()}catch(e){c.ZP.error(e instanceof Error?e.message:"خطا")}}async function x(e){try{await (0,i.Nv)("/admin/loans/".concat(e,"/approve"),{method:"POST"}),c.ZP.success("وام تایید شد"),await o()}catch(e){c.ZP.error(e instanceof Error?e.message:"خطا")}}async function p(e){try{await (0,i.Nv)("/admin/loans/".concat(e,"/reject"),{method:"POST"}),c.ZP.success("وام رد شد"),await o()}catch(e){c.ZP.error(e instanceof Error?e.message:"خطا")}}async function g(){try{await (0,i.Nv)("/admin/system/backups/run",{method:"POST"}),c.ZP.success("بکاپ دستی اجرا شد"),await o()}catch(e){c.ZP.error(e instanceof Error?e.message:"خطا در بکاپ")}}return(0,n.jsxs)("div",{className:"space-y-8",dir:"rtl",children:[(0,n.jsx)("h1",{className:"text-4xl font-bold",children:"مالی، وام و بکاپ"}),(0,n.jsxs)("div",{className:"grid md:grid-cols-4 gap-4",children:[(0,n.jsxs)("div",{className:"card glass p-4",children:["برداشت در انتظار: ",m.pendingWCount.toLocaleString("fa-IR")]}),(0,n.jsxs)("div",{className:"card glass p-4",children:["مبلغ برداشت در انتظار: ",m.pendingWAmount.toLocaleString("fa-IR")]}),(0,n.jsxs)("div",{className:"card glass p-4",children:["وام در انتظار: ",m.pendingLCount.toLocaleString("fa-IR")]}),(0,n.jsxs)("div",{className:"card glass p-4",children:["مبلغ وام در انتظار: ",m.pendingLAmount.toLocaleString("fa-IR")]})]}),(0,n.jsxs)("section",{className:"card glass p-6",children:[(0,n.jsx)("h2",{className:"text-2xl font-black mb-3",children:"درخواست های برداشت"}),(0,n.jsx)("div",{className:"space-y-2",children:e.map(e=>(0,n.jsxs)("div",{className:"p-3 rounded-lg border border-white/10 bg-black/20 flex justify-between items-center",children:[(0,n.jsxs)("div",{children:[(0,n.jsx)("p",{children:e.userEmail}),(0,n.jsxs)("p",{className:"text-xs text-white/60",children:[e.amount.toLocaleString("fa-IR")," - ",e.status]})]}),"pending"===e.status?(0,n.jsxs)("div",{className:"flex gap-2",children:[(0,n.jsx)("button",{onClick:()=>h(e.id),className:"btn-secondary",children:"تایید"}),(0,n.jsx)("button",{onClick:()=>u(e.id),className:"btn-secondary",children:"رد"})]}):null]},e.id))})]}),(0,n.jsxs)("section",{className:"card glass p-6",children:[(0,n.jsx)("h2",{className:"text-2xl font-black mb-3",children:"درخواست های وام"}),(0,n.jsx)("div",{className:"space-y-2",children:a.map(e=>(0,n.jsxs)("div",{className:"p-3 rounded-lg border border-white/10 bg-black/20 flex justify-between items-center",children:[(0,n.jsxs)("div",{children:[(0,n.jsxs)("p",{children:[e.id," - ",e.userId]}),(0,n.jsxs)("p",{className:"text-xs text-white/60",children:[e.principalIrr.toLocaleString("fa-IR")," - ",e.status]})]}),"pending"===e.status?(0,n.jsxs)("div",{className:"flex gap-2",children:[(0,n.jsx)("button",{onClick:()=>x(e.id),className:"btn-secondary",children:"تایید"}),(0,n.jsx)("button",{onClick:()=>p(e.id),className:"btn-secondary",children:"رد"})]}):null]},e.id))})]}),(0,n.jsxs)("section",{className:"card glass p-6",children:[(0,n.jsxs)("div",{className:"flex items-center justify-between mb-3",children:[(0,n.jsx)("h2",{className:"text-2xl font-black",children:"بکاپ های روزانه"}),(0,n.jsx)("button",{onClick:g,className:"btn-primary",children:"اجرای بکاپ"})]}),(0,n.jsxs)("div",{className:"space-y-2",children:[l.map(e=>{var s;return(0,n.jsxs)("div",{className:"p-3 rounded-lg border border-white/10 bg-black/20 text-sm",children:[(0,n.jsxs)("p",{children:[e.id," - ",e.status]}),(0,n.jsx)("p",{className:"text-white/60",children:new Date(e.startedAt).toLocaleString("fa-IR")}),(0,n.jsx)("p",{className:"text-white/60",children:null!==(s=e.storageUri)&&void 0!==s?s:"-"})]},e.id)}),l.length?null:(0,n.jsx)("p",{className:"text-white/60",children:"بکاپی وجود ندارد."})]})]})]})}}},function(e){e.O(0,[5186,1837,2971,2117,1744],function(){return e(e.s=9054)}),_N_E=e.O()}]);