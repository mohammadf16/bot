(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[7702],{684:function(e,t,r){Promise.resolve().then(r.bind(r,6067))},8755:function(e,t,r){"use strict";r.d(t,{Z:function(){return d}});var n=r(2265);let a=function(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];return t.filter((e,t,r)=>!!e&&""!==e.trim()&&r.indexOf(e)===t).join(" ").trim()},l=e=>e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),s=e=>e.replace(/^([A-Z])|[\s-_]+(\w)/g,(e,t,r)=>r?r.toUpperCase():t.toLowerCase()),c=e=>{let t=s(e);return t.charAt(0).toUpperCase()+t.slice(1)};var o={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};let i=e=>{for(let t in e)if(t.startsWith("aria-")||"role"===t||"title"===t)return!0;return!1},u=(0,n.forwardRef)((e,t)=>{let{color:r="currentColor",size:l=24,strokeWidth:s=2,absoluteStrokeWidth:c,className:u="",children:d,iconNode:h,...f}=e;return(0,n.createElement)("svg",{ref:t,...o,width:l,height:l,stroke:r,strokeWidth:c?24*Number(s)/Number(l):s,className:a("lucide",u),...!d&&!i(f)&&{"aria-hidden":"true"},...f},[...h.map(e=>{let[t,r]=e;return(0,n.createElement)(t,r)}),...Array.isArray(d)?d:[d]])}),d=(e,t)=>{let r=(0,n.forwardRef)((r,s)=>{let{className:o,...i}=r;return(0,n.createElement)(u,{ref:s,iconNode:t,className:a("lucide-".concat(l(c(e))),"lucide-".concat(e),o),...i})});return r.displayName=c(e),r}},4401:function(e,t,r){"use strict";r.d(t,{Z:function(){return n}});let n=(0,r(8755).Z)("activity",[["path",{d:"M22 12h-2.48a2 2 0 0 0-1.93 1.46l-2.35 8.36a.25.25 0 0 1-.48 0L9.24 2.18a.25.25 0 0 0-.48 0l-2.35 8.36A2 2 0 0 1 4.49 12H2",key:"169zse"}]])},4766:function(e,t,r){"use strict";r.d(t,{Z:function(){return n}});let n=(0,r(8755).Z)("bell",[["path",{d:"M10.268 21a2 2 0 0 0 3.464 0",key:"vwvbt9"}],["path",{d:"M3.262 15.326A1 1 0 0 0 4 17h16a1 1 0 0 0 .74-1.673C19.41 13.956 18 12.499 18 8A6 6 0 0 0 6 8c0 4.499-1.411 5.956-2.738 7.326",key:"11g9vi"}]])},5080:function(e,t,r){"use strict";r.d(t,{Z:function(){return n}});let n=(0,r(8755).Z)("ticket",[["path",{d:"M2 9a3 3 0 0 1 0 6v2a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2v-2a3 3 0 0 1 0-6V7a2 2 0 0 0-2-2H4a2 2 0 0 0-2 2Z",key:"qn84l0"}],["path",{d:"M13 5v2",key:"dyzc3o"}],["path",{d:"M13 17v2",key:"1ont0d"}],["path",{d:"M13 11v2",key:"1wjjxi"}]])},9474:function(e,t,r){"use strict";r.d(t,{Z:function(){return n}});let n=(0,r(8755).Z)("trophy",[["path",{d:"M10 14.66v1.626a2 2 0 0 1-.976 1.696A5 5 0 0 0 7 21.978",key:"1n3hpd"}],["path",{d:"M14 14.66v1.626a2 2 0 0 0 .976 1.696A5 5 0 0 1 17 21.978",key:"rfe1zi"}],["path",{d:"M18 9h1.5a1 1 0 0 0 0-5H18",key:"7xy6bh"}],["path",{d:"M4 22h16",key:"57wxv0"}],["path",{d:"M6 9a6 6 0 0 0 12 0V3a1 1 0 0 0-1-1H7a1 1 0 0 0-1 1z",key:"1mhfuq"}],["path",{d:"M6 9H4.5a1 1 0 0 1 0-5H6",key:"tex48p"}]])},5805:function(e,t,r){"use strict";r.d(t,{Z:function(){return n}});let n=(0,r(8755).Z)("users",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["path",{d:"M16 3.128a4 4 0 0 1 0 7.744",key:"16gr8j"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}]])},1804:function(e,t,r){"use strict";r.d(t,{Z:function(){return n}});let n=(0,r(8755).Z)("wallet",[["path",{d:"M19 7V4a1 1 0 0 0-1-1H5a2 2 0 0 0 0 4h15a1 1 0 0 1 1 1v4h-3a2 2 0 0 0 0 4h3a1 1 0 0 0 1-1v-2a1 1 0 0 0-1-1",key:"18etb6"}],["path",{d:"M3 5v14a2 2 0 0 0 2 2h15a1 1 0 0 0 1-1v-4",key:"xoc0q4"}]])},1239:function(e,t,r){"use strict";r.d(t,{Z:function(){return n}});let n=(0,r(8755).Z)("zap",[["path",{d:"M4 14a1 1 0 0 1-.78-1.63l9.9-10.2a.5.5 0 0 1 .86.46l-1.92 6.02A1 1 0 0 0 13 10h7a1 1 0 0 1 .78 1.63l-9.9 10.2a.5.5 0 0 1-.86-.46l1.92-6.02A1 1 0 0 0 11 14z",key:"1xq2db"}]])},7648:function(e,t,r){"use strict";r.d(t,{default:function(){return a.a}});var n=r(2972),a=r.n(n)},257:function(e,t,r){"use strict";var n,a;e.exports=(null==(n=r.g.process)?void 0:n.env)&&"object"==typeof(null==(a=r.g.process)?void 0:a.env)?r.g.process:r(4227)},4227:function(e){!function(){var t={229:function(e){var t,r,n,a=e.exports={};function l(){throw Error("setTimeout has not been defined")}function s(){throw Error("clearTimeout has not been defined")}function c(e){if(t===setTimeout)return setTimeout(e,0);if((t===l||!t)&&setTimeout)return t=setTimeout,setTimeout(e,0);try{return t(e,0)}catch(r){try{return t.call(null,e,0)}catch(r){return t.call(this,e,0)}}}!function(){try{t="function"==typeof setTimeout?setTimeout:l}catch(e){t=l}try{r="function"==typeof clearTimeout?clearTimeout:s}catch(e){r=s}}();var o=[],i=!1,u=-1;function d(){i&&n&&(i=!1,n.length?o=n.concat(o):u=-1,o.length&&h())}function h(){if(!i){var e=c(d);i=!0;for(var t=o.length;t;){for(n=o,o=[];++u<t;)n&&n[u].run();u=-1,t=o.length}n=null,i=!1,function(e){if(r===clearTimeout)return clearTimeout(e);if((r===s||!r)&&clearTimeout)return r=clearTimeout,clearTimeout(e);try{r(e)}catch(t){try{return r.call(null,e)}catch(t){return r.call(this,e)}}}(e)}}function f(e,t){this.fun=e,this.array=t}function m(){}a.nextTick=function(e){var t=Array(arguments.length-1);if(arguments.length>1)for(var r=1;r<arguments.length;r++)t[r-1]=arguments[r];o.push(new f(e,t)),1!==o.length||i||c(h)},f.prototype.run=function(){this.fun.apply(null,this.array)},a.title="browser",a.browser=!0,a.env={},a.argv=[],a.version="",a.versions={},a.on=m,a.addListener=m,a.once=m,a.off=m,a.removeListener=m,a.removeAllListeners=m,a.emit=m,a.prependListener=m,a.prependOnceListener=m,a.listeners=function(e){return[]},a.binding=function(e){throw Error("process.binding is not supported")},a.cwd=function(){return"/"},a.chdir=function(e){throw Error("process.chdir is not supported")},a.umask=function(){return 0}}},r={};function n(e){var a=r[e];if(void 0!==a)return a.exports;var l=r[e]={exports:{}},s=!0;try{t[e](l,l.exports,n),s=!1}finally{s&&delete r[e]}return l.exports}n.ab="//";var a=n(229);e.exports=a}()},6067:function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return y}});var n=r(7437),a=r(2265),l=r(4072),s=r(5080),c=r(1804),o=r(1239),i=r(5805);let u=(0,r(8755).Z)("receipt",[["path",{d:"M4 2v20l2-1 2 1 2-1 2 1 2-1 2 1 2-1 2 1V2l-2 1-2-1-2 1-2-1-2 1-2-1-2 1Z",key:"q3az6g"}],["path",{d:"M16 8h-6a2 2 0 1 0 0 4h4a2 2 0 1 1 0 4H8",key:"1h4pet"}],["path",{d:"M12 17.5v-11",key:"1jc1ny"}]]);var d=r(4766),h=r(4401),f=r(9474),m=r(7648),x=r(5186),p=r(1837),v=r(7766);function y(){var e,t,r;let{user:y,refreshMe:g}=(0,v.a)(),[b,w]=(0,a.useState)([]),[N,k]=(0,a.useState)({totalReferrals:0}),[j,A]=(0,a.useState)([]),[T,S]=(0,a.useState)([]);(0,a.useEffect)(()=>{(async()=>{try{await g();let[e,t,r,n]=await Promise.all([(0,p.Nv)("/me/tickets"),(0,p.Nv)("/me/referral"),(0,p.Nv)("/me/history"),(0,p.Nv)("/me/activity")]);w(e.items),k(t),A(r.items),S(n.items)}catch(e){x.ZP.error(e instanceof Error?e.message:"خطا در دریافت داشبورد")}})()},[g]);let Z=(0,a.useMemo)(()=>j.filter(e=>"cashback"===e.type).reduce((e,t)=>e+t.amount,0),[j]),M=[{label:"بلیط های فعال",value:b.length.toLocaleString("fa-IR"),icon:s.Z,color:"text-blue-500"},{label:"موجودی کیف پول",value:(null!==(e=null==y?void 0:y.walletBalance)&&void 0!==e?e:0).toLocaleString("fa-IR"),unit:"تومان",icon:c.Z,color:"text-accent-gold"},{label:"شانس قرعه",value:(null!==(t=null==y?void 0:y.chances)&&void 0!==t?t:0).toLocaleString("fa-IR"),icon:o.Z,color:"text-purple-500"},{label:"کش بک",value:Z.toLocaleString("fa-IR"),unit:"تومان",icon:c.Z,color:"text-cyan-400"},{label:"زیرمجموعه",value:N.totalReferrals.toLocaleString("fa-IR"),icon:i.Z,color:"text-emerald-500"}];return(0,n.jsxs)("div",{className:"space-y-10",dir:"rtl",children:[(0,n.jsxs)("div",{children:[(0,n.jsxs)("h1",{className:"text-3xl font-black tracking-tight mb-2",children:["سلام، ",(0,n.jsx)("span",{className:"text-accent-gold",children:null!==(r=null==y?void 0:y.email)&&void 0!==r?r:"کاربر"})]}),(0,n.jsx)("p",{className:"text-white/40 text-sm font-bold",children:"خلاصه حساب، اعلان ها و گردش آخر فعالیت های شما"})]}),(0,n.jsx)("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-5 gap-6",children:M.map((e,t)=>{let r=e.icon;return(0,n.jsxs)(l.E.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.08*t},className:"bg-[#0A0A0A] border border-white/5 p-6 rounded-[2rem]",children:[(0,n.jsx)("div",{className:"w-12 h-12 bg-white/5 rounded-2xl flex items-center justify-center mb-4",children:(0,n.jsx)(r,{className:"w-6 h-6 ".concat(e.color)})}),(0,n.jsx)("p",{className:"text-white/40 text-xs mb-1",children:e.label}),(0,n.jsxs)("div",{className:"flex items-baseline gap-2",children:[(0,n.jsx)("span",{className:"text-2xl font-black",children:e.value}),e.unit&&(0,n.jsx)("span",{className:"text-[10px] text-white/20",children:e.unit})]})]},t)})}),(0,n.jsxs)("section",{className:"grid md:grid-cols-2 lg:grid-cols-4 gap-4",children:[(0,n.jsxs)(m.default,{href:"/wallet",className:"bg-[#0A0A0A] border border-white/5 p-5 rounded-2xl hover:border-accent-gold/30 transition-colors",children:[(0,n.jsx)(c.Z,{className:"text-accent-gold mb-3"}),(0,n.jsx)("p",{className:"font-black",children:"کیف پول"})]}),(0,n.jsxs)(m.default,{href:"/dashboard/tickets",className:"bg-[#0A0A0A] border border-white/5 p-5 rounded-2xl hover:border-accent-gold/30 transition-colors",children:[(0,n.jsx)(u,{className:"text-accent-gold mb-3"}),(0,n.jsx)("p",{className:"font-black",children:"تاریخچه بلیط"})]}),(0,n.jsxs)(m.default,{href:"/dashboard/referral",className:"bg-[#0A0A0A] border border-white/5 p-5 rounded-2xl hover:border-accent-gold/30 transition-colors",children:[(0,n.jsx)(i.Z,{className:"text-accent-gold mb-3"}),(0,n.jsx)("p",{className:"font-black",children:"زیرمجموعه گیری"})]}),(0,n.jsxs)(m.default,{href:"/dashboard/notifications",className:"bg-[#0A0A0A] border border-white/5 p-5 rounded-2xl hover:border-accent-gold/30 transition-colors",children:[(0,n.jsx)(d.Z,{className:"text-accent-gold mb-3"}),(0,n.jsx)("p",{className:"font-black",children:"اعلان ها"})]})]}),(0,n.jsxs)("div",{className:"space-y-4",children:[(0,n.jsxs)("h2",{className:"text-xl font-black flex items-center gap-2",children:[(0,n.jsx)(h.Z,{className:"text-accent-gold"})," گردش آخر حساب"]}),T.slice(0,8).map(e=>(0,n.jsxs)("div",{className:"bg-[#0A0A0A] border border-white/5 p-4 rounded-2xl flex items-center justify-between gap-4",children:[(0,n.jsxs)("div",{children:[(0,n.jsx)("p",{className:"font-bold",children:e.title}),(0,n.jsx)("p",{className:"text-xs text-white/40",children:new Date(e.createdAt).toLocaleString("fa-IR")}),e.body?(0,n.jsx)("p",{className:"text-xs text-white/60 mt-1",children:e.body}):null]}),(0,n.jsxs)("div",{className:"text-left",children:[(0,n.jsx)("p",{className:"text-xs text-white/40",children:e.source}),"number"==typeof e.amount?(0,n.jsxs)("p",{className:"font-bold",children:[e.amount.toLocaleString("fa-IR")," تومان"]}):null]})]},e.id)),T.length?null:(0,n.jsx)("p",{className:"text-sm text-white/50",children:"فعلا فعالیتی ثبت نشده است."})]}),(0,n.jsxs)("div",{className:"space-y-4",children:[(0,n.jsxs)("h2",{className:"text-xl font-black flex items-center gap-2",children:[(0,n.jsx)(f.Z,{className:"text-accent-gold"})," بلیط های من"]}),b.slice(0,5).map(e=>(0,n.jsxs)("div",{className:"bg-[#0A0A0A] border border-white/5 p-5 rounded-2xl flex items-center justify-between",children:[(0,n.jsxs)("div",{children:[(0,n.jsx)("p",{className:"font-bold",children:e.raffleTitle}),(0,n.jsxs)("p",{className:"text-xs text-white/40",children:["کد بلیط: ",e.id," - شماره: ",e.index.toLocaleString("fa-IR")]})]}),(0,n.jsxs)("div",{className:"text-left",children:[(0,n.jsxs)("p",{className:"font-bold",children:[e.pricePaid.toLocaleString("fa-IR")," تومان"]}),(0,n.jsx)("p",{className:"text-xs text-white/40",children:e.raffleStatus})]})]},e.id))]})]})}},1837:function(e,t,r){"use strict";r.d(t,{Je:function(){return d},Nv:function(){return m},c8:function(){return x},hP:function(){return i},vD:function(){return u}});var n,a=r(257);let l=null!==(n=a.env.NEXT_PUBLIC_API_URL)&&void 0!==n?n:"http://localhost:4000/api/v1",s=a.env.NEXT_PUBLIC_API_GATEWAY_KEY,c="car_access_token",o="car_refresh_token";function i(){return localStorage.getItem(c)}function u(e){localStorage.setItem(c,e.accessToken),localStorage.setItem(o,e.refreshToken)}function d(){localStorage.removeItem(c),localStorage.removeItem(o)}async function h(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=arguments.length>2?arguments[2]:void 0,n=new Headers(t.headers);void 0!==t.body&&null!==t.body&&n.set("Content-Type","application/json"),s&&n.set("x-api-gateway-key",s),r&&n.set("Authorization","Bearer ".concat(r));let a=await fetch("".concat(l).concat(e),{...t,headers:n});if(!a.ok){var c,o;let e=await a.json().catch(()=>({}));throw Error(null!==(o=null!==(c=e.error)&&void 0!==c?c:e.message)&&void 0!==o?o:"HTTP_".concat(a.status))}return 204===a.status?{}:await a.json()}async function f(){let e=localStorage.getItem(o);if(!e)return null;try{let t=await h("/auth/refresh",{method:"POST",body:JSON.stringify({refreshToken:e})});return u(t),t.accessToken}catch(e){return d(),null}}async function m(e){var t;let r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{auth:!0},a=null===(t=n.auth)||void 0===t||t,l=a?i():void 0;try{return await h(e,r,null!=l?l:void 0)}catch(n){if(!a)throw n;let t=await f();if(!t)throw n;return h(e,r,t)}}function x(){return"undefined"!=typeof crypto&&"randomUUID"in crypto?crypto.randomUUID():"idemp-".concat(Date.now(),"-").concat(Math.random().toString(16).slice(2))}},7766:function(e,t,r){"use strict";r.d(t,{H:function(){return o},a:function(){return i}});var n=r(7437),a=r(2265),l=r(1837);let s=(0,a.createContext)(null);async function c(){return(0,l.Nv)("/me",{method:"GET"},{auth:!0})}function o(e){let{children:t}=e,[r,o]=(0,a.useState)(null),[i,u]=(0,a.useState)(!0),d=(0,a.useCallback)(async()=>{o(await c())},[]);(0,a.useEffect)(()=>{let e=!0;return(async()=>{try{let t=await c();e&&o(t)}catch(t){e&&o(null)}finally{e&&u(!1)}})(),()=>{e=!1}},[]);let h=(0,a.useCallback)(async e=>{let{email:t,password:r}=e,n=await (0,l.Nv)("/auth/login",{method:"POST",body:JSON.stringify({email:t,password:r})},{auth:!1});return(0,l.vD)({accessToken:n.accessToken,refreshToken:n.refreshToken}),o(n.user),n.user},[]),f=(0,a.useCallback)(async e=>{let{email:t,password:r,referralCode:n}=e;await (0,l.Nv)("/auth/register",{method:"POST",body:JSON.stringify({email:t,password:r,referralCode:n})},{auth:!1})},[]),m=(0,a.useCallback)(async()=>{try{let e=localStorage.getItem("car_refresh_token");e&&await (0,l.Nv)("/auth/logout",{method:"POST",body:JSON.stringify({refreshToken:e})})}catch(e){}finally{(0,l.Je)(),o(null)}},[]),x=(0,a.useMemo)(()=>({user:r,isLoading:i,isAuthenticated:!!r,login:h,register:f,logout:m,refreshMe:d}),[r,i,h,f,m,d]);return(0,n.jsx)(s.Provider,{value:x,children:t})}function i(){let e=(0,a.useContext)(s);if(!e)throw Error("useAuth must be used within AuthProvider");return e}}},function(e){e.O(0,[5186,4072,2972,2971,2117,1744],function(){return e(e.s=684)}),_N_E=e.O()}]);