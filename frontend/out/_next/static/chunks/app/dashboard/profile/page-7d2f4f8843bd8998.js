(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[5544],{8874:function(e,t,a){Promise.resolve().then(a.bind(a,4916))},8755:function(e,t,a){"use strict";a.d(t,{Z:function(){return u}});var l=a(2265);let s=function(){for(var e=arguments.length,t=Array(e),a=0;a<e;a++)t[a]=arguments[a];return t.filter((e,t,a)=>!!e&&""!==e.trim()&&a.indexOf(e)===t).join(" ").trim()},i=e=>e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),r=e=>e.replace(/^([A-Z])|[\s-_]+(\w)/g,(e,t,a)=>a?a.toUpperCase():t.toLowerCase()),n=e=>{let t=r(e);return t.charAt(0).toUpperCase()+t.slice(1)};var c={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};let o=e=>{for(let t in e)if(t.startsWith("aria-")||"role"===t||"title"===t)return!0;return!1},d=(0,l.forwardRef)((e,t)=>{let{color:a="currentColor",size:i=24,strokeWidth:r=2,absoluteStrokeWidth:n,className:d="",children:u,iconNode:h,...m}=e;return(0,l.createElement)("svg",{ref:t,...c,width:i,height:i,stroke:a,strokeWidth:n?24*Number(r)/Number(i):r,className:s("lucide",d),...!u&&!o(m)&&{"aria-hidden":"true"},...m},[...h.map(e=>{let[t,a]=e;return(0,l.createElement)(t,a)}),...Array.isArray(u)?u:[u]])}),u=(e,t)=>{let a=(0,l.forwardRef)((a,r)=>{let{className:c,...o}=a;return(0,l.createElement)(d,{ref:r,iconNode:t,className:s("lucide-".concat(i(n(e))),"lucide-".concat(e),c),...o})});return a.displayName=n(e),a}},4766:function(e,t,a){"use strict";a.d(t,{Z:function(){return l}});let l=(0,a(8755).Z)("bell",[["path",{d:"M10.268 21a2 2 0 0 0 3.464 0",key:"vwvbt9"}],["path",{d:"M3.262 15.326A1 1 0 0 0 4 17h16a1 1 0 0 0 .74-1.673C19.41 13.956 18 12.499 18 8A6 6 0 0 0 6 8c0 4.499-1.411 5.956-2.738 7.326",key:"11g9vi"}]])},9345:function(e,t,a){"use strict";a.d(t,{Z:function(){return l}});let l=(0,a(8755).Z)("mail",[["path",{d:"m22 7-8.991 5.727a2 2 0 0 1-2.009 0L2 7",key:"132q7q"}],["rect",{x:"2",y:"4",width:"20",height:"16",rx:"2",key:"izxlao"}]])},3041:function(e,t,a){"use strict";a.d(t,{Z:function(){return l}});let l=(0,a(8755).Z)("phone",[["path",{d:"M13.832 16.568a1 1 0 0 0 1.213-.303l.355-.465A2 2 0 0 1 17 15h3a2 2 0 0 1 2 2v3a2 2 0 0 1-2 2A18 18 0 0 1 2 4a2 2 0 0 1 2-2h3a2 2 0 0 1 2 2v3a2 2 0 0 1-.8 1.6l-.468.351a1 1 0 0 0-.292 1.233 14 14 0 0 0 6.392 6.384",key:"9njp5v"}]])},3229:function(e,t,a){"use strict";a.d(t,{Z:function(){return l}});let l=(0,a(8755).Z)("save",[["path",{d:"M15.2 3a2 2 0 0 1 1.4.6l3.8 3.8a2 2 0 0 1 .6 1.4V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2z",key:"1c8476"}],["path",{d:"M17 21v-7a1 1 0 0 0-1-1H8a1 1 0 0 0-1 1v7",key:"1ydtos"}],["path",{d:"M7 3v4a1 1 0 0 0 1 1h7",key:"t51u73"}]])},2369:function(e,t,a){"use strict";a.d(t,{Z:function(){return l}});let l=(0,a(8755).Z)("user",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]])},4916:function(e,t,a){"use strict";a.r(t),a.d(t,{default:function(){return b}});var l=a(7437),s=a(2265),i=a(4072),r=a(2369),n=a(3041),c=a(8755);let o=(0,c.Z)("map-pin",[["path",{d:"M20 10c0 4.993-5.539 10.193-7.399 11.799a1 1 0 0 1-1.202 0C9.539 20.193 4 14.993 4 10a8 8 0 0 1 16 0",key:"1r0f0z"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}]]),d=(0,c.Z)("image",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",ry:"2",key:"1m3agn"}],["circle",{cx:"9",cy:"9",r:"2",key:"af1f0g"}],["path",{d:"m21 15-3.086-3.086a2 2 0 0 0-2.828 0L6 21",key:"1xmnt7"}]]);var u=a(9345),h=a(4766);let m=(0,c.Z)("shield",[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}]]);var x=a(3229),f=a(5186),p=a(1837),v=a(7766);function b(){var e;let{user:t,refreshMe:a}=(0,v.a)(),[c,b]=(0,s.useState)(!0),[w,g]=(0,s.useState)(!1),[j,k]=(0,s.useState)({fullName:"",username:"",phone:"",city:"",address:"",bio:"",avatarUrl:"",notificationPrefs:{email:!0,sms:!1,push:!0}});async function C(){b(!0);try{var e,t,a,l,s,i,r,n;let c=await (0,p.Nv)("/me/profile",{method:"GET"});k({fullName:null!==(e=c.profile.fullName)&&void 0!==e?e:"",username:null!==(t=c.profile.username)&&void 0!==t?t:"",phone:null!==(a=c.profile.phone)&&void 0!==a?a:"",city:null!==(l=c.profile.city)&&void 0!==l?l:"",address:null!==(s=c.profile.address)&&void 0!==s?s:"",bio:null!==(i=c.profile.bio)&&void 0!==i?i:"",avatarUrl:null!==(r=c.profile.avatarUrl)&&void 0!==r?r:"",notificationPrefs:null!==(n=c.notificationPrefs)&&void 0!==n?n:{email:!0,sms:!1,push:!0}})}catch(e){f.ZP.error(e instanceof Error?e.message:"خطا در دریافت اطلاعات پروفایل")}finally{b(!1)}}(0,s.useEffect)(()=>{C()},[]);let A=(0,s.useMemo)(()=>(j.fullName||(null==t?void 0:t.email)||"کاربر").slice(0,1).toUpperCase(),[j.fullName,null==t?void 0:t.email]);async function Z(){g(!0);try{await (0,p.Nv)("/me/profile",{method:"PATCH",body:JSON.stringify({fullName:j.fullName||void 0,username:j.username||void 0,phone:j.phone||void 0,city:j.city||void 0,address:j.address||void 0,bio:j.bio||void 0,avatarUrl:j.avatarUrl||void 0,notificationPrefs:j.notificationPrefs})}),await a(),f.ZP.success("پروفایل با موفقیت ذخیره شد")}catch(e){f.ZP.error(e instanceof Error?e.message:"خطا در ذخیره پروفایل")}finally{g(!1)}}return(0,l.jsxs)("div",{className:"space-y-8",dir:"rtl",children:[(0,l.jsx)("div",{className:"flex items-center justify-between",children:(0,l.jsxs)("div",{children:[(0,l.jsx)("h1",{className:"text-3xl font-black",children:"پروفایل کاربری"}),(0,l.jsx)("p",{className:"text-white/40 text-sm mt-1",children:"اطلاعات حساب، هویت و اعلان‌ها را مدیریت کنید."})]})}),(0,l.jsxs)("div",{className:"grid lg:grid-cols-[320px,1fr] gap-6",children:[(0,l.jsx)(i.E.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},className:"bg-[#0A0A0A] border border-white/5 rounded-[2rem] p-6",children:(0,l.jsxs)("div",{className:"flex flex-col items-center text-center",children:[(0,l.jsx)("div",{className:"w-24 h-24 rounded-full bg-white/10 border border-white/20 flex items-center justify-center text-3xl font-black text-accent-gold",children:A}),(0,l.jsx)("p",{className:"mt-4 font-black",children:j.fullName||"بدون نام"}),(0,l.jsx)("p",{className:"text-xs text-white/40 mt-1",children:null==t?void 0:t.email}),(0,l.jsxs)("div",{className:"mt-4 w-full bg-white/5 rounded-xl p-3 border border-white/10 text-xs text-white/70",children:["سطح دسترسی: ",(null==t?void 0:t.role)==="admin"?"مدیر":"کاربر"]})]})}),(0,l.jsxs)(i.E.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{delay:.05},className:"space-y-6",children:[(0,l.jsxs)("section",{className:"bg-[#0A0A0A] border border-white/5 rounded-[2rem] p-6",children:[(0,l.jsxs)("h2",{className:"text-xl font-black mb-5 flex items-center gap-2",children:[(0,l.jsx)(r.Z,{className:"w-5 h-5 text-accent-gold"})," اطلاعات پایه"]}),(0,l.jsxs)("div",{className:"grid md:grid-cols-2 gap-4",children:[(0,l.jsx)(y,{icon:(0,l.jsx)(r.Z,{className:"w-4 h-4 text-white/40"}),label:"نام و نام خانوادگی",children:(0,l.jsx)("input",{value:j.fullName,onChange:e=>k(t=>({...t,fullName:e.target.value})),className:"input",placeholder:"مثال: علی محمدی"})}),(0,l.jsx)(y,{icon:(0,l.jsx)(r.Z,{className:"w-4 h-4 text-white/40"}),label:"نام کاربری",children:(0,l.jsx)("input",{value:j.username,onChange:e=>k(t=>({...t,username:e.target.value})),className:"input",placeholder:"مثال: ali_m"})}),(0,l.jsx)(y,{icon:(0,l.jsx)(n.Z,{className:"w-4 h-4 text-white/40"}),label:"شماره موبایل",children:(0,l.jsx)("input",{value:j.phone,onChange:e=>k(t=>({...t,phone:e.target.value})),className:"input",placeholder:"0912..."})}),(0,l.jsx)(y,{icon:(0,l.jsx)(o,{className:"w-4 h-4 text-white/40"}),label:"شهر",children:(0,l.jsx)("input",{value:j.city,onChange:e=>k(t=>({...t,city:e.target.value})),className:"input",placeholder:"تهران"})}),(0,l.jsx)(y,{icon:(0,l.jsx)(d,{className:"w-4 h-4 text-white/40"}),label:"لینک آواتار",children:(0,l.jsx)("input",{value:j.avatarUrl,onChange:e=>k(t=>({...t,avatarUrl:e.target.value})),className:"input",placeholder:"https://..."})}),(0,l.jsx)(y,{icon:(0,l.jsx)(u.Z,{className:"w-4 h-4 text-white/40"}),label:"ایمیل",children:(0,l.jsx)("input",{value:null!==(e=null==t?void 0:t.email)&&void 0!==e?e:"",className:"input opacity-60",disabled:!0})})]}),(0,l.jsxs)("div",{className:"mt-4",children:[(0,l.jsx)("label",{className:"text-xs text-white/50 mb-2 block",children:"آدرس"}),(0,l.jsx)("input",{value:j.address,onChange:e=>k(t=>({...t,address:e.target.value})),className:"input w-full",placeholder:"آدرس کامل"})]}),(0,l.jsxs)("div",{className:"mt-4",children:[(0,l.jsx)("label",{className:"text-xs text-white/50 mb-2 block",children:"بیو"}),(0,l.jsx)("textarea",{value:j.bio,onChange:e=>k(t=>({...t,bio:e.target.value})),className:"input w-full min-h-24",placeholder:"توضیح کوتاه درباره خودتان"})]})]}),(0,l.jsxs)("section",{className:"bg-[#0A0A0A] border border-white/5 rounded-[2rem] p-6",children:[(0,l.jsxs)("h2",{className:"text-xl font-black mb-5 flex items-center gap-2",children:[(0,l.jsx)(h.Z,{className:"w-5 h-5 text-accent-cyan"})," تنظیمات اعلان"]}),(0,l.jsxs)("div",{className:"grid md:grid-cols-3 gap-3",children:[(0,l.jsx)(N,{label:"ایمیل",checked:j.notificationPrefs.email,onChange:e=>k(t=>({...t,notificationPrefs:{...t.notificationPrefs,email:e}}))}),(0,l.jsx)(N,{label:"پیامک",checked:j.notificationPrefs.sms,onChange:e=>k(t=>({...t,notificationPrefs:{...t.notificationPrefs,sms:e}}))}),(0,l.jsx)(N,{label:"Push",checked:j.notificationPrefs.push,onChange:e=>k(t=>({...t,notificationPrefs:{...t.notificationPrefs,push:e}}))})]})]}),(0,l.jsxs)("section",{className:"bg-[#0A0A0A] border border-white/5 rounded-[2rem] p-6",children:[(0,l.jsxs)("h2",{className:"text-xl font-black mb-4 flex items-center gap-2",children:[(0,l.jsx)(m,{className:"w-5 h-5 text-rose-400"})," امنیت"]}),(0,l.jsx)("p",{className:"text-sm text-white/50 mb-4",children:"در نسخه بعدی: تغییر رمز عبور، خروج از همه دستگاه‌ها و تایید دو مرحله‌ای."}),(0,l.jsxs)("button",{onClick:Z,disabled:w||c,className:"btn-primary w-full md:w-auto disabled:opacity-60",children:[(0,l.jsx)(x.Z,{className:"w-4 h-4"}),w?"در حال ذخیره...":"ذخیره تغییرات"]})]})]})]})]})}function y(e){let{label:t,icon:a,children:s}=e;return(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{className:"text-xs text-white/50 mb-2 block",children:t}),(0,l.jsxs)("div",{className:"bg-white/5 border border-white/10 rounded-xl px-3 py-2 flex items-center gap-2",children:[a,(0,l.jsx)("div",{className:"flex-1",children:s})]})]})}function N(e){let{label:t,checked:a,onChange:s}=e;return(0,l.jsxs)("button",{type:"button",onClick:()=>s(!a),className:"p-4 rounded-xl border text-right transition ".concat(a?"border-accent-gold bg-accent-gold/10":"border-white/10 bg-white/5"),children:[(0,l.jsx)("p",{className:"font-bold",children:t}),(0,l.jsx)("p",{className:"text-xs text-white/50 mt-1",children:a?"فعال":"غیرفعال"})]})}},7766:function(e,t,a){"use strict";a.d(t,{H:function(){return o},a:function(){return d}});var l=a(7437),s=a(2265),i=a(1837),r=a(5572);let n=(0,s.createContext)(null);async function c(){return(0,i.Nv)("/me",{method:"GET"},{auth:!0})}function o(e){let{children:t}=e,[a,o]=(0,s.useState)(null),[d,u]=(0,s.useState)(!0),h=(0,s.useCallback)(async()=>{try{let e=await c();o(e)}catch(e){o(null)}},[]);(0,s.useEffect)(()=>{let e=!0;return(async()=>{try{let t=await c();e&&o(t)}catch(t){e&&o(null)}finally{e&&u(!1)}})(),()=>{e=!1}},[]);let m=(0,s.useCallback)(async e=>{let{email:t,password:a}=e,l=await (0,i.Nv)("/auth/login",{method:"POST",body:JSON.stringify({email:t,password:a})},{auth:!1});return(0,i.vD)({accessToken:l.accessToken,refreshToken:l.refreshToken}),(0,r.DM)(l.user),o(l.user),l.user},[]),x=(0,s.useCallback)(async e=>{let{email:t,password:a,referralCode:l}=e;await (0,i.Nv)("/auth/register",{method:"POST",body:JSON.stringify({email:t,password:a,referralCode:l})},{auth:!1})},[]),f=(0,s.useCallback)(async()=>{try{await (0,i.Nv)("/auth/logout",{method:"POST",body:JSON.stringify({})})}catch(e){}finally{(0,i.Je)(),(0,r.DM)(null),o(null)}},[]),p=(0,s.useMemo)(()=>({user:a,isLoading:d,isAuthenticated:!!a,login:m,register:x,logout:f,refreshMe:h}),[a,d,m,x,f,h]);return(0,l.jsx)(n.Provider,{value:p,children:t})}function d(){let e=(0,s.useContext)(n);if(!e)throw Error("useAuth must be used within AuthProvider");return e}}},function(e){e.O(0,[5186,4072,1837,2971,2117,1744],function(){return e(e.s=8874)}),_N_E=e.O()}]);